<div class="row subHeader actionsBar">
    <table style="width:100%;height: 55px;">
          <tbody><tr>
            <td class="appTd">
            <div class="btn-group">
                 <a class="filterItem" href="#" data-toggle="dropdown" style="margin-right:0px">
                  {% if active_app.label =="Relationships" %}
                      <img class="app_icon" src="../../static/src/img/sm-iogrow-true.png" style="display:inline-block;height: 20px;margin-right: 3px;">
                      {% else%}
                      <img class="app_icon" src="../../static/src/img/admin_min.png" style="display:inline-block;height: 20px;margin-right: 3px;">
                  {% endif %}
                  <span class="hide_sm">{{_(active_app.label)}}</span>   
                  <i class="icon-angle-down fa fa-angle-down"></i>
                 </a>
                 <ul class="dropdown-menu">
                  {%for application in apps %}
                        {% if application.label =="Relationships" %}
                          <li><a href="/apps/{{ application.key.id() }}" data-toggle="modal"><img class="app_icon" src="../../static/src/img/sm-iogrow-true.png" style="display:inline-block;height: 20px;margin-right: 3px;">{{_(application.label)}}</a></li>
                          {% else%}
                           <li><a href="/apps/{{ application.key.id() }}" data-toggle="modal"><img class="app_icon" src="../../static/src/img/admin_min.png" style="display:inline-block;height: 20px;margin-right: 3px;">{{_(application.label)}}</a></li>
                        
                          {% endif %}
                       

                  {%endfor%}
                 </ul>
             </div>
          </td>
      <td>
        <div class="col-md-9 mainHeader">
        <div class="subheadContient" style="padding-top: 5px;float: left;vertical-align: middle;">              
              <div class="subHeaderActions" style="vertical-align: middle;padding-left: 15px;">
                <a href="/#/opportunities" data-toggle="tooltip" data-placement="bottom" title="Back to Leads">
                <img onload="this.__gwtLastUnhandledEvent = & quot; load & quot; ;" src="https://admin.google.com/a/cpanel/gwt/cpanelnew/resources/clear.cache.gif" style="width: 21px; height: 21px; background-image: url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABUAAAAVCAYAAACpF6WWAAAAP0lEQVR42mNgGAXDApRT28AGIP5PCwP/08LA/9QKw/9kYLyggxaGYjMYHyApiBpoYSixSYqsyGwYzf+jgDQAAJylMNOnx10yAAAAAElFTkSuQmCC); background-position: 0px 0px; background-repeat: no-repeat no-repeat;" border="0" class="gwt-Image GI4HA0EPK cbarOpacity" aria-hidden="false"></a> 
                <a class="headerBtn" title="Refresh" ng-click="runTheProcess();"> 
                      <i class="fa fa-repeat" style="padding-top: 6px; font-size: 16px;"></i>
                </a>
                <a class="headerBtn" title="Add tags" ng-click="showAssigneeTagsToOpportunity()" ng-hide=" selectedCards.length==0"> 
                      + <i class="fa fa-tags"></i>
                </a>
                <a ng-show="opportunity.owner.google_user_id=={{ME}}||{{is_admin}}" class="" href="#sharingSettingsModal" data-toggle="modal" title="Share" style="font-size: 16px;color: #737373;cursor: pointer;margin-left: 12px; margin-right: 12px;"> 
                      <i class="fa fa-share-square-o" style="padding-top: 6px; font-size: 16px;"></i>
                </a>
                <a class="headerBtn" title="Delete"  ng-show="selectedTab==2"  ng-click="editbeforedelete(opportunity,'opportunity')"> 
                      <i class="fa fa-trash-o"></i>
                </a>
                <a class="headerBtn" title="Delete" ng-show="selectedTab==7&&selectedDocs.length > 0" ng-click="editbeforedeleteDoc()">
                    <i class="fa fa-trash-o"></i>
                </a>
                <div class="btn-group show_md" style="margin-left: 8px; margin-right: 0px; vertical-align: baseline;">
                  <a class="headerBtn" title="More" data-toggle="dropdown"> 
                     <!-- <i class="fa  fa-ellipsis-vertical" style="padding-top: 6px; font-size: 16px;"></i>-->
                     More
                  </a>
                  <ul class="dropdown-menu drp-dwn-right">
                    <li>
                       <a class="" title="Share" style="font-size: 16px;color: #737373;cursor: pointer;margin-left: 12px; margin-right: 12px;" ng-click="switchShow()"> 
                              <i class="fa fa-share-square-o" style="padding-top: 6px; font-size: 16px;"></i>
                        </a>
               
                    </li>
                    <li>
                       <a class="" title="Convert" style="font-size: 16px;color: #737373;cursor: pointer;margin-left: 12px; margin-right: 12px;" ng-click="switchShow()"> 
                          <i class="fa  fa-refresh" style="padding-top: 6px; font-size: 16px;"></i>
                       </a>
                    </li>                                                         
                  </ul>
              </div> 
              </div>
               <div class="communicationBottons pull-right">
                    <a ng-show="infonodes.emails[0].email" class="" title="Send an Email" style="font-size: 16px;color: #737373;cursor: pointer;margin-left: 12px; margin-right: 12px;" ng-click="gotosendMail(infonodes.emails[0].email)"> 
                      <i class="fa fa-envelope" style="padding-top: 6px; font-size: 16px;"></i>
                    </a>
                    <div id="placeholder-div1" class="pull-right hangout-btn" style=" margin-top: -1px !important; margin-left: 15px !important;"></div> 
                    <a  ng-show="screen_name" href="https://twitter.com/intent/tweet?screen_name=<%=screen_name%>" title="Tweet" style="  font-size: 16px;color: #737373;cursor: pointer;margin-left: 12px; margin-right: 12px;" ng-click="switchShow()"> 
                          <i class="fa fa-twitter" style="padding-top: 6px; font-size: 16px;"></i>
                    </a>  
                    <script>
                    !function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');
                    </script>                
              </div>
              <div class="clearfix"></div>
        </div>
           <a  class="btn red newAccountBtnOnscroll oppNewBtn pull-right" style="/* margin-top: -4px; */" ng-click="showEdit=!showEdit" ng-show="selectedTab==2">
             <span ng-hide="showEdit"><i class="fa fa-pencil"></i> Edit</span>
             <span ng-show="showEdit"><i class="fa fa-save"></i> Save</span>
           </a>
           <div class="btn-group relbutton pull-right" ng-show="selectedTab==7" style="padding:0px">
                             <div class="btn-group" style="margin-right: 5px;">
                                <button ng-click="createPickerUploader()" id="sample_editable_1_new" class="btn red">
                                    <i class="fa fa-upload"></i>
                                </button>

                            </div>
                            <div class="btn-group">
                                <a class="btn red" href="#" data-toggle="dropdown">
                                    <i class="fa  fa-file-o"></i> {{ _(' New document') }}
                                    <i class="icon-angle-down"></i>
                                </a>
                                <ul class="dropdown-menu">
                                    <li><a ng-click="showCreateDocument('document')" href="#" data-toggle="modal">
                                        <img src="/static/src/img/google_drive/text/plain.png" class="">
                                        {{ _('Document') }}
                                    </a>
                                    </li>
                                    <li><a ng-click="showCreateDocument('presentation')" href="#" data-toggle="modal">
                                        <img src="/static/src/img/google_drive/presentation.png" class="">
                                        {{ _('Presentation') }}
                                    </a>
                                    </li>
                                    <li><a ng-click="showCreateDocument('spreadsheet')" href="#" data-toggle="modal">
                                        <img src="/static/src/img/google_drive/spreadsheet.png" class="">
                                        {{ _('Spreadsheet') }}
                                    </a>
                                    </li>

                                </ul>
                            </div>
                        </div>
                 
      </div>
      <div class="col-md-3">  
            <div style=" padding-left: 10px;" class="pull-right">
              <a class="headerBtn hide_sm" title="View" style="margin-left: 6px;margin-right: 12px;" ng-click="switchShow()"> 
                  <i class="fa fa-th-large" style="padding-top: 6px; font-size: 16px; display: none;" ng-show="show=='list'"></i>
                  <i class="fa fa-list" style="padding-top: 6px; font-size: 16px;" ng-show="show=='cards'"></i>
              </a>
               {%for application in apps %}
                 {%if application.label =="Settings" %}
                  <a  href="/apps/{{ application.key.id() }}" class="headerBtn hide_sm" title="Settings" style="margin-left: 20px; margin-right: 12px;" > 
                      <i class="fa fa-gear" style="padding-top: 6px; font-size: 16px;"></i>
                  </a>
                 {%endif%}
               {%endfor%}  
              <div class="btn-group show_sm" style="margin-left: 8px; margin-right: 0px; vertical-align: baseline;">
                  <a class="headerBtn" title="More" data-toggle="dropdown"> 
                      <i class="fa  fa-ellipsis-vertical" style="padding-top: 6px; font-size: 16px;"></i>
                  </a>
                  <ul class="dropdown-menu drp-dwn-right">
                    {%for application in apps %}
                       {%if application.label =="Settings" %}
                        <li>
                        <a  href="/apps/{{ application.key.id() }}" class="" title="Settings" > 
                            <i class="fa fa-gear" style="padding-top: 6px; font-size: 16px;"></i>
                            Settings
                        </a>
                        </li> 
                       {%endif%}
                    {%endfor%}                                       
                  </ul>
              </div>           
          </div>
          </div>
      </td>
          </tr>
          
        </tbody>
  </table>
</div>

<div  class="page-content" style="margin-top: 45px;">
  <div class="loader-container row" ng-show="isLoading">
    <div class="loader-dialog col-md-4 col-md-offset-4 ">
      <div class="loader-content">
        {{_('Loading...')}}
      </div>
    </div>
  </div>
  <div class="container" ng-show="immediateFailed">
    <div class="col-md-12">

      <span id="signin">
        <span id="myGsignin"></span>
      </span>
    </div>
  </div>
      <!-- get timezone setting from user -->
    <input type="hidden" value="{{user.timezone}}" id="timezone"/>
  <div class="row">
    <div class="col-md-9">
      <div class="row">
        <div class="showPage custom-show margin-bottom-15  col-md-12">
          <div class="row margin-bottom-10">

            <div class="col-md-12">
            <div class="row">
              <div class="col-md-3 col-sm-3 col-xs-3" ng-mouseenter="showUpload = true" ng-mouseleave="showUpload = false" style="padding-right:0px;display: table;vertical-align: middle;text-align: center;
">
                  <div class="pic" style="vertical-align:middle;display: table-cell;">
                      <img alt="<%= account.name %>" class="yemyem img-responsive img-thumbnail" ng-src="<%= opportunity.accounts[0].logo_img_id ? 'https://docs.google.com/uc?id='+ opportunity.accounts[0].logo_img_id : '/static/src/img/default_company.png' %>" style="width: 140px;height: auto;">
                  </div>
              </div>
              <div class="col-md-9 col-sm-9 col-xs-9" style="min-height: 113px;display: table; padding-left:0px;padding-right: 0px;">
                  <h3 style="margin-top: 0px;  margin-bottom: 5px;"> 
                    <span ng-hide="showEdit"><%= opportunity.name%></span>
                    <form ng-show="showEdit" class="form-inline newLeadForm" role="form" style="  margin-right: 2px;display: inline-block;float: left;margin-bottom: 0px;width: calc(100% - 176px);">
                        <div class="input-icon">
                              <i class="fa fa-pencil"></i>
                             <input class="  form-control" type="text" placeholder="Account name" ng-model="opportunity.name" ng-blur="updateOppName(opportunity.name)" ng-enter="updateOppName(opportunity.name)">
                        </div>

                    </form> 
                     <button ng-show="opportunity.current_stage.probability!='0'&&opportunity.current_stage.probability!='100'" style="line-height: 25px;background: #28b779 !important;" droppable=""  ng-click="updateOpportunityStage(wonStage)" class="btn green btn-sm pull-right">
                        <i class="fa fa-trophy" style="font-size: 19px;"></i> Won
                      </button>
                      <button ng-show="opportunity.current_stage.probability!='0'&&opportunity.current_stage.probability!='100'" class="btn red btn-sm pull-right"  ng-click="updateOpportunityStage(lostStage)" style="line-height: 25px;  margin-right: 13px;"> 
                           <i class="fa  fa-thumbs-down" style="font-size: 19px;"></i> Lost
                      </button>
                    <div class="btn-group pull-right">
                    <button  ng-show="opportunity.current_stage.probability=='100'||opportunity.current_stage.probability=='0'" id="btnGroupVerticalDrop8" type="button" class="btn green dropdown-toggle" data-toggle="dropdown" style="width: 143px;">
                    Reactivate to <i class="fa fa-angle-down"></i>
                    </button>
                    <ul class="dropdown-menu" role="menu" aria-labelledby="btnGroupVerticalDrop8">
                      <li ng-repeat="opps in insideStages">
                        <a ng-click="updateOpportunityStage(opps)" ng-href="#<%='tab'+$index%>" data-toggle="tab"><%=opps.name%> - <%=opps.probability%> %</a>
                      </li>
                    </ul>
                  </div>
                  <div class="clearfix"></div>
                  </h3>  
                  <p ng-show="opportunity.accounts[0].id">
                          <a ng-hide="showEdit&&!opportunity.accounts" href="/#/accounts/show/<%=opportunity.accounts[0].id%>" style="font-size: 14px; font-weight: 700;  margin-bottom: 5px;"><%=opportunity.accounts[0].name%></a>
                          <div class="input-icon" ng-show="showEdit&&opportunity.accounts">
                          <i class="fa fa-building"></i>
                          <input type="text" required  ng-model="searchAccountQuery" typeahead="accountResult as accountResult.name  for accountResult in accountsResults | filter:$viewValue | limitTo:10" typeahead-on-select="selectAccount()" class="form-control" placeholder="{{_('Account')}}">
                          </div>
                           
                           <a ng-hide="showEdit||(!opportunity.contacts&&!opportunity.contact)" href="/#/contacts/show/<%=opportunity.contacts[0].id%>" style="font-size: 14px;">(  <%=opportunity.contacts[0].firstname%> <%=opportunity.contacts[0].lastname %> ) </a>  
                          <a ng-hide="showEdit||!opportunity.lead" ng-show="opportunity.lead" href="/#/leads/show/<%=opportunity.lead.id%>" style="font-size: 14px;">(  <%=opportunity.lead.firstname%> <%=opportunity.lead.lastname %> ) </a>  
                          <div class="input-icon" ng-show="showEdit&&opportunity.lead" style="margin-top:10px">
                              <i class="fa fa-user"></i>
                              <input type="text" required ng-model="searchLeadQuery" typeahead="leadResult as leadResult.firstname + ' '+  leadResult.lastname for leadResult in leadsResults | filter:$viewValue | limitTo:10" typeahead-on-select="selectLead()" class="form-control" placeholder="{{_('Lead')}}">
                          </div>
                  </p>
                  <p ng-hide="showEdit" style="font-size: 20px;color: rgb(216, 74, 56);padding-right: 15px;  margin-bottom: 5px;">
                      <span>
                          <%= opportunity.currency %>
                      </span>
                      <span>
                          <%= opportunity.amount_total | curr:'{{length_decimal}}':'{{length_whole_part}}':"{{sections_delimiter}}":"{{decimal_delimiter}}"%>
                      </span>
                      
                  </p>
                  <div  style="padding-right: 0px;  margin-bottom: 0px !important;" class="form-group currencyForm" ng-show="showEdit">
                    <div class="col-md-3 margin-bottom-10" style="padding-left:0px">
                        <input type="text" required id="id_name" class="form-control" placeholder="{{_('Opportunity amount...')}}" ng-model="opportunity.amount_per_unit " ng-blur="updateOpportunityPrice()">
                     </div>
                    <div class="col-md-3 margin-bottom-10">
                     <select  class="form-control" ng-model="opportunity.currency" ng-change="updateOpportunityPrice()">
                      <option value="USD" selected>$ - USD</option>
                      <option value="EUR">€ - EUR</option>
                      <option value="CAD">$ - CAD</option>
                      <option value="GBP">£ - GBP</option>
                      <option value="AUD">$ - AUD</option>
                      <option value="">---</option>
                      <option value="AED">د.إ - AED</option>
                      <option value="ANG">ƒ - ANG</option>
                      <option value="AOA">AOA - AOA</option>
                      <option value="ARS">$ - ARS</option>
                      <option value="BAM">KM - BAM</option>
                      <option value="BBD">$ - BBD</option>
                      <option value="BGL">лв - BGL</option>
                      <option value="BHD">BD - BHD</option>
                      <option value="BND">$ - BND</option>
                      <option value="BRL">R$ - BRL</option>
                      <option value="BTC">฿ - BTC</option>
                      <option value="CHF">Fr - CHF</option>
                      <option value="CLF">UF - CLF</option>
                      <option value="CLP">$ - CLP</option>
                      <option value="CNY">¥ - CNY</option>
                      <option value="COP">$ - COP</option>
                      <option value="CRC">₡ - CRC</option>
                      <option value="CZK">Kč - CZK</option>
                      <option value="DKK">kr - DKK</option>
                      <option value="EEK">KR - EEK</option>
                      <option value="EGP">E£ - EGP</option>
                      <option value="FJD">FJ$ - FJD</option>
                      <option value="GTQ">Q - GTQ</option>
                      <option value="HKD">$ - HKD</option>
                      <option value="HRK">kn  - HRK</option>
                      <option value="HUF">Ft - HUF</option>
                      <option value="IDR">Rp - IDR</option>
                      <option value="ILS">₪ - ILS</option>
                      <option value="INR">₨ - INR</option>
                      <option value="IRR">ریال - IRR</option>
                      <option value="ISK">kr - ISK</option>
                      <option value="JOD">د.ا - JOD</option>
                      <option value="JPY">¥ - JPY</option>
                      <option value="KES">KSh - KES</option>
                      <option value="KRW">₩ - KRW</option>
                      <option value="KWD">KD - KWD</option>
                      <option value="KYD">$ - KYD</option>
                      <option value="LTL">Lt - LTL</option>
                      <option value="LVL">Ls - LVL</option>
                      <option value="MAD">د.م. - MAD</option>
                      <option value="MVR">Rf - MVR</option>
                      <option value="MXN">$ - MXN</option>
                      <option value="MYR">RM - MYR</option>
                      <option value="NGN">₦ - NGN</option>
                      <option value="NOK">kr - NOK</option>
                      <option value="NZD">$ - NZD</option>
                      <option value="OMR">ر.ع - OMR</option>
                      <option value="PEN">S/. - PEN</option>
                      <option value="PHP">₱ - PHP</option>
                      <option value="PLN">zł - PLN</option>
                      <option value="QAR">ر.ق - QAR</option>
                      <option value="RON">L - RON</option>
                      <option value="RUB">руб. - RUB</option>
                      <option value="SAR">ر.س - SAR</option>
                      <option value="SEK">kr - SEK</option>
                      <option value="SGD">$ - SGD</option>
                      <option value="THB">฿ - THB</option>
                      <option value="TRY">TL - TRY</option>
                      <option value="TTD">$ - TTD</option>
                      <option value="TWD">$ - TWD</option>
                      <option value="UAH">₴ - UAH</option>
                      <option value="VEF">Bs F - VEF</option>
                      <option value="VND">₫ - VND</option>
                      <option value="XCD">$ - XCD</option>
                      <option value="ZAR">R - ZAR</option>
                      <option value="DZD">د.ج- DZD</option>
                    </select>
                    </div>
                      <div class="col-md-3 margin-bottom-10">
                          <select   ng-click="showPriceForm=true" class="form-control" ng-model="opportunity.duration_unit" ng-change="updateOpportunityPrice()">
                              <option value="fixed">{{ _('Fixed bid')}}</option>
                              <option value="hour">{{ _('Per hour')}}</option>
                              <option value="month">{{ _('Per month')}}</option>
                              <option value="year">{{ _('Per year')}}</option>
                          </select>
                      </div>
                      <div ng-hide="opportunity.duration_unit=='fixed'" class="col-md-3 margin-bottom-10">
                         <input ng-click="showPriceForm=true"  type="text" pattern="\d*"  required id="" class="form-control" ng-model="opportunity.duration" ng-blur="updateOpportunityPrice()">
                      </div>
                      <!-- <div class="col-md-3 margin-bottom-10">
                        <div class="">
                         <button class="btn blue btn-sm" ng-click="updateOpportunityPrice()" style="  height: 34px;">{{_("Ok")}}</button>
                         <button class="btn btn-sm" ng-click="showPriceForm=falsee" style="height: 34px;">{{_("Cancel")}}</button>
                        </div>

                      </div> -->
                      <div class="clearfix"></div>
                  </div>
                  <p style="font-size: 13px;color: gray;padding-right: 15px;">
                      <span ng-hide="showEdit">
                         Close date :
                          <%=opportunity.closed_date | date:'yyyy-MM-dd - HH:mm:ss '%></span>
                      </span> 
                  </p>
                      <div ng-show="showEdit" class="input-icon col-md-6" style="padding-left:0px">
                         <i class="fa fa-calendar"></i>
                         <input cdatetimepicker data-model="opportunity.closed_date" type="text" class="form-control" placeholder="{{ _('Click to change the estimated date')}}" value="" id="leadEventStartsAt">
                      </div>
                      <span  class="margin-bottom-15">
                                <datetimepick ng-model='opportunity.closed_date'  label-format='EEEE, MMMM d, yyyy'></datetimepick>
                      </span>                
                  
                  <p ng-show="opportunity.current_stage.probability=='100'" style="font-size: 21px;font-weight: 500; color: rgb(40, 183, 121);"> 
                    <i class="fa  fa fa-trophy" style="font-size: 21px;"></i> Congratulation, Opportunity Won !
                  </p>
                  <p ng-show="opportunity.current_stage.probability=='0'" style="font-size: 21px;font-weight: 500; color: rgb(216, 74, 56);">
                     <i class="fa  fa-thumbs-down" style="font-size: 21px;"></i> Opportunity lost !
                  </p>
              </div>
        <div class="col-md-12">
         <div class="custom_wizard" id="form_wizard_1" ng-show="opportunity.current_stage.probability!='0'&&opportunity.current_stage.probability!='100'">
            <div class="portlet-body form">
              <form action="#" class="form-horizontal" id="submit_form" id="form_wizard_1">
                <div class="form-wizard">
                  <div class="form-body">
                    <ul class="nav nav-pills nav-justified steps" >
                      <li ng-repeat="opps in insideStages" id="wizardstep"
                      ng-class="{'done' : opps.stage_number < opportunity.current_stage.stage_number, 'active' : opps.stage_number == opportunity.current_stage.stage_number}">
                        <a ng-click="updateOpportunityStage(opps)" ng-href="#<%='tab'+$index%>" data-toggle="tab" class="step">
                        <span class="number">
                          <%=$index%>                          
                        </span>
                        <span class="desc">
                          <i class="fa fa-check"></i> <%=opps.name%>
                        </span>
                        </a>
                      </li>
                    </ul>
                    <div id="bar" class="progress progress-striped" role="progressbar" style="position:relative !important">
                      <div class="progress-bar progress-bar-success" style="height:100%!important">
                      </div>
                    </div>
                    
                  </div>
                  <div class="form-actions fluid" style="display:none">
                    <div class="row">
                      <div class="col-md-12">
                        <div class="col-md-offset-3 col-md-9">
                          <a href="javascript:;" class="btn default button-previous">
                          <i class="m-icon-swapleft"></i> Back </a>
                          <a href="javascript:;" class="btn blue button-next">
                          Continue <i class="m-icon-swapright m-icon-white"></i>
                          </a>
                          <a href="javascript:;" class="btn green button-submit">
                          Submit <i class="m-icon-swapright m-icon-white"></i>
                          </a>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </form>
            </div>
          </div>
        </div>
      </div>
      </div>
          </div>
          <div class="row">
            <div class="col-md-12">
              <div class="tabbable tabbable-custom">
                <ul class="nav nav-tabs">
                  <li class="ng-tab" ng-class="{active: selectedTab == 2}">
                    <a ng-click="selectedTab = 2;renderMaps();">
                    <i class="fa fa-home"></i>{{ _(' About')}}</a>
                  </li>
                  <!--<li class="ng-tab" ng-class="{active: selectedTab == 1}">
                    <a ng-click="selectedTab = 1;">{{ _('Notes')}}</a>
                  </li>-->
                  <!--<li class="ng-tab sm-menu" ng-class="{active: selectedTab ==8}">
                    <a ng-click="selectedTab = 8;">{{ _('Send an Email')}}</a>
                  </li>-->
                  <li class="ng-tab sm-menu" ng-class="{active: selectedTab == 7}">
                    <a ng-click="waterfallTrigger();selectedTab = 7;">
                    <i class="fa fa-folder-open"></i>{{ _(' Documents')}}</a>
                  </li>
                  <li class="dropdown md-menu-inv">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">
                      {{ _('More')}} <i class="fa fa-angle-down"></i>
                    </a>
                    <ul class="dropdown-menu" role="menu">
                      <li class="ng-tab sm-menu-inv" ng-class="{active: selectedTab ==8}"><a ng-click="selectedTab = 8;">{{ _('Send an Email')}}</a></li>
                      <li class="ng-tab sm-menu-inv" ng-class="{active: selectedTab == 7}"><a ng-click="selectedTab = 7;">{{ _('Attach Documents')}}</a></li>
                    </ul>
                  </li>
                </ul>
              </div>
            </div>
          </div>
        </div>
        <div class="col-md-12">
          <div class="row">
            <div class="">
              <div class="tab-content">
                <div class="tab-pane active" id="tab_1_1" ng-show="selectedTab == 1">
                  <div class="showPage">
                    <div class="row">
                      <div class="col-md-12  margin-bottom-10">
                        <p class⁼"lead"="">
                          {{ _('To add an outside email to this account, forward or BCC to:')}}
                          <a href="mailto:{{ME}}@gcdc2013-iogrow.appspotmail.com">
                            {{ME}}@gcdc2013-iogrow.appspotmail.com
                          </a>
                          <br>
                          {{ _('Or just add notes to remember what\'s important.')}}
                          <br>
                        </p>
                        <form id="addNote"class="ng-pristine ng-valid">
                          <div class="form-group">
                            <input class="form-control ng-pristine ng-valid" autofocus="" type="text" placeholder="{{_('Add a new subject')}}" id="messageSubject" ng-model="note.title">
                          </div>
                          <div class="form-group">
                            <textarea id="noteBody" class="form-control ng-pristine ng-valid" rows="3" ng-model="note.content"></textarea>
                          </div>
                          <div class="pull-right">
                            <input ng-disabled="isLoading"  ng-click="addNote(note)"  type="submit" class="btn green" value="Add this note">
                          </div>
                        </form>
                      </div>
                    </div>
                    <ul class="chats">
                      <li class="in" ng-repeat="topic in topics" id="topic_<%=$index%>">
                        <img class="avatar" alt="" ng-src="<%= topic.last_updater.photo%>" />
                        <div class="message">
                          <span class="arrow"></span>
                          <a  class="name">
                            <%= topic.last_updater.display_name%>
                          </a>
                          <span class="datetime">
                            at <%=topic.updated_at | date:'yyyy-MM-dd - HH:mm:ss '  %>
                          </span>
                          <span class="body">
                            <a href="<%=getTopicUrl(topic.topic_kind,topic.id)%>" class="discussion-content"><strong class="ng-binding">
                              <%= topic.title%></strong> - <span class="excerpt ng-binding" ng-bind-html-unsafe="topic.excerpt"></span><span class="chat-meta pull-right" ng-show="topic.comments"><i class="icon-comment"></i> <%= topic.comments%> comments</span>
                            </a>
                          </span>
                        </div>
                      </li>
                    </ul>

                  </div>
                </div>

                      <!--HKA 06.03.2014 About -->
                      <div class="tab-pane active" id="tab_1_2" ng-show="selectedTab == 2">
                  <div class="row">
                    <div class="col-md-6">
                    <div class="news-blocks blank-card blank-card-red newsCard">
                          <h3><i class="fa fa-dot-circle-o" style="font-size: 24px;"></i> {{ _(' Qualification')}}</h3>
                          <div class="news-block-tags">
                            <div class="form-group row hidden" >
                              <label class="control-label col-md-4"><i class="fa fa-money"></i> {{ _(' Budget')}}</label>
                              <div class="col-md-8">
                                <div class="row">
                                  <div class="col-md-4" style="padding-right: 0px;">
                                    <select class="form-control">
                                        <option value="yes">{{ _('Yes')}}</option>
                                        <option value="no">{{ _('No')}}</option>                                        
                                    </select>
                                  </div>
                                  <div class="col-md-8"  style="padding-left: 5px;">
                                     <input class="form-control ng-pristine ng-valid" autofocus="" type="text" placeholder="{{_('Amount')}}"  >
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                          <div class="news-block-tags">
                            <div class="form-group row">
                              <label class="control-label col-md-4"><i class="fa fa-shopping-cart"></i> {{ _(' Need')}}</label>
                               <div class="col-md-8">
                                <textarea  ng-blur="updateOpportunity({'id':opportunity.id,'need':opportunity.need})" ng-model="opportunity.need"class="form-control ng-pristine ng-valid" rows="3" ></textarea>
                              </div>
                            </div>
                          </div>


                                <div class="news-block-tags">
                                  <div class="form-group row">
                                    <label class="control-label col-md-4"><i class="fa fa-group"></i>{{ _(' Competitors')}}</label>
                                      <!--<div class="col-md-8">
                                        <textarea id="noteBody"  ng-model="opportunity.competitor" class="form-control ng-pristine ng-valid" rows="3" ></textarea>
                                      </div>-->
                                    <div class="col-md-8">
                                        <div class="" ng-class="{ 'has-error': oppo_err.account && oppo_err.contact }"
                                             style="margin-bottom:15px">
                                            <div class="input-icon">
                                                <i class="fa fa-search"></i>
                                                <input type="text" typeahead-loading="compSearchLoading"
                                                       ng-class="{'spinner':compSearchLoading}" required
                                                       ng-model="searchCompetitorQuery"
                                                       typeahead="competitorResult as competitorResult.name  for competitorResult in getResults($viewValue,'/crmengine/v1/accounts/search') | filter:$viewValue | limitTo:10"
                                                       typeahead-on-select="selectCompetitor()"
                                                       ng-enter="selectCompetitor()" class="form-control"
                                                       placeholder="{{_('  Add a competitor...')}}"
                                                       style="padding-left: 24px!important;">
                                            </div>
                                        </div>
                                        <ul class="list-unstyled contact-infos infoslist">
                                            <li ng-repeat="competitor in opportunity.competitors">
                                                <img class="contact-photo"
                                                     src="<%=competitor.logo_img_url || '/static/src/img/default_company.png'%>">
                                             <span>
                                                <a href="/#/accounts/show/<%= competitor.id %>"> <%= competitor.name
                                                    %></a>
                                                  
                                              </span>
                                                <button type="button" class="close closeContactForm" tabindex='-1'
                                                        ng-click="editbeforedisassociate(competitor,opportunity.competitors,'competitor')"></button>
                                                <div class="clearfix"></div>
                                                <div class="pull-right">
                                                </div>
                                            </li>
                                        </ul>
                                    </div>
                                      <div class="clearfix"></div>
                                  </div>
                                </div>
                              <div class="news-block-tags">
                                <div class="form-group row">
                                  <label class="control-label col-md-4"><i class="fa fa-gears "></i> {{ _(' Descision Process')}}</label>
                                   <div class="col-md-8">
                                    <textarea  ng-blur="updateOpportunity({'id':opportunity.id,'decission_process':opportunity.decission_process})" ng-model="opportunity.decission_process"   class="form-control ng-pristine ng-valid" rows="3" ></textarea>
                                  </div>
                                </div>
                              </div>
                        <div class="news-block-tags">
                                <div class="form-group row">
                                  <label class="control-label col-md-4"><i class="fa fa-clock-o "></i> {{ _(' Decision process Timeline')}}</label>
                                   <div class="col-md-8">
                                       <a href="" ng-click="showAddTimeScale()" style="cursor:pointer">
                                           + <i class="fa fa-calendar" style="font-size:13px"></i> Add an event</a>
                                       <!-- <textarea ng-model="opportunity.time_scale" class="form-control" rows="3" ></textarea>-->
                                       <ul id="tasks" class="list-unstyled lead_related_events" ng-hide="newEventform">
                                           <li ng-repeat="event in opportunity.timeline.items" id="event_<%=$index%>"
                                               class="relatedEventItem" ng-mouseenter="showDeleteBtn = true"
                                               ng-mouseleave="showDeleteBtn = false">
                                               <div class="event-container">
                                                   <div class="showDescription">
                                            <span class="relatedEventTitle">
                                              <a href="/#/events/show/<%=event.id%>" class="">
                                                  <%= event.title%>
                                              </a>
                                            </span>
                                                       <a class="pull-right relatedEventMoreBtn">
                                                           <i class="fa fa-chevron-right" ng-hide="showDetails"
                                                              ng-click="showDetails=true"></i>
                                                           <i class="fa fa-chevron-down" ng-show="showDetails"
                                                              ng-click="showDetails=false"></i>
                                                       </a>
                                                       <a class="pull-left relatedEventDeleteBtn"
                                                          ng-show="showDeleteBtn" ng-click="deleteTimeItem(event)">
                                                           <i class="fa fa fa-times-circle"></i>
                                                       </a>
                                            <span class="relatedEventStartsAt pull-right" ng-hide="showDetails"
                                                  ng-show="event.starts_at"
                                                  title="<%= event.starts_at | date:'yyyy-MM-dd '%>">
                                                  <%= event.starts_at | date:'dd MMM yyyy'%>
                                            </span>
                                                   </div>
                                                   <div class="moreDetails row" ng-show="showDetails">
                                                       <div class="col-md-5 col-xs-5 event-schedule">
                                                <span class=""><i class="fa fa-calendar"></i>
                                                <%= event.starts_at | date:'dd MMM yyyy'%> </span>
                                                       </div>
                                                       <div class="col-md-2 col-xs-2 event-schedule">
                                                           <i class="fa fa-chevron-right"></i>
                                                       </div>
                                                       <div class="col-md-5 col-xs-5 event-schedule">
                                               <span class="">
                                                  <i class="fa fa-calendar"></i>
                                                  <%= event.ends_at | date:'dd MMM yyyy'%>
                                                </span>
                                                       </div>
                                                       <div class="col-md-12">
                                               <span class="">
                                                  <i class="fa fa-map-marker"></i>
                                                  <%= event.where %>
                                                </span>
                                                       </div>
                                                   </div>
                                               </div>
                                           </li>
                                       </ul>
                                  </div>
                                </div>

                              </div>
                        </div>
                       <div class="news-blocks blank-card blank-card-gray newsCard" ng-class="{'disabledBlock':isEmptyArray(opportunities.customfields)}" >
                                             <span class="page-meta pull-right" ng-show="!isEmptyArray(opportunities.customfields)">
                                               <a href="/#/admin/custom_fields/2"  class="btn-link addAnotherPhone" data-toggle="modal" style="color:gray;"><i class="fa fa-pencil"></i> {{_('Edit Custom fields')}} </a>
                                             </span>
                                    <h3 style="margin-top:0px;font-size:20px"><i class="fa fa fa-list-alt" style="font-size:18px"></i>{{ _(' Custom Fields') }}</h3>
                                        <div ng-show="isEmptyArray(opportunities.customfields)" style="text-align:center">
                                                  <a href="/#/admin/custom_fields/2" class=" newRelatedContact" style="font-size: 13px;color: rgb(209, 38, 16);font-weight: bold;cursor:pointer;">
                                                    + <i class="fa fa-list-alt"></i>  Add Custom fields
                                                  </a> 
                                        </div>
                                        <ul ng-show="!isEmptyArray(opportunities.customfields)" style="list-style: none;padding-left: 0px;">
                                            <li ng-repeat="cusfield in opportunities.customfields"  style="padding: 5px;">
                                                <div class="form-group" style="margin-bottom: 5px;">
                                                    <div class="row">
                                                        <label ng-model="cusfield.field" class="control-label col-md-12">
                                                            <%=cusfield.name%>
                                                        </label>
                                                    </div>
                                                    <div class="row">
                                                        <div class="col-md-12" id="elementContainer" >
                                                            <select class="form-control" ng-show="cusfield.field_type=='list'" ng-change="addCustomField(cusfield)"  ng-model="cusfield.value" ng-options="option for option in cusfield.options">
                                                            </select>
                                                            <div ng-show="cusfield.field_type=='radio'" role="radiogroup" ng-repeat="option in cusfield.options">
                                                                <input id="<%=cusfield.id%>_<%=option%>_<%=$index%>" type="radio" ng-model="cusfield.value" value="<%=option%>"  ng-click="addCustomField(cusfield)">
                                                                <label for="<%=cusfield.id%>_<%=option%>_<%=$index%>" ng-click="addCustomField(cusfield)"> <%=option%></label>
                                                                <br>        
                                                            </div>
                                                            <div ng-show="cusfield.field_type=='checkbox'" role="radiogroup" ng-repeat="option in cusfield.options">
                                                                <input type="checkbox" value="<%=option%>" ng-click="addCustomField(cusfield,option)"  ng-checked="cusfield.value.indexOf(option) > -1" id="<%=cusfield.id%>_check_<%=option%>_<%=$index%>">
                                                                <label for="<%=cusfield.id%>_check_<%=option%>_<%=$index%>"> <%=option%></label ng-click="addCustomField(cusfield,option)">
                                                                <br>        
                                                            </div>
                                                            <input ng-blur="addCustomField(cusfield)" ng-model="cusfield.value" type="text" class="form-control" ng-show="cusfield.field_type=='text'">
                                                            <textarea ng-model="cusfield.value" ng-blur="addCustomField(cusfield)" class="form-control" ng-show="cusfield.field_type=='paragraph'"></textarea>

                                                        </div>

                                                    </div>
                                                </div>
                                            </li>
                                        </ul>
                                        
                                        
                                         <div class="clearfix"></div>
                                </div>
                      <div ng-show="!isEmptyArray(infonodes.customfields)" class="news-blocks blank-card blank-card-gray newsCard">
                        <h3><i class="fa fa fa-list-alt" style="font-size:20px"></i> {{ _('Other details')}}</h3>
                        <ul class="list-unstyled contact-infos showList">   
                            
                            <li ng-repeat="custom in infonodes.customfields">
                               
                                 <form editable-form name="editableCustomFieldForm" onbeforesave="inlinePatch('Infonode','customfields', custom.fields[0].field,custom.entityKey,custom.fields[0].value)" class="customFieldForm"> 
                                    <i class="fa fa-gear" ng-hide="editableCustomFieldForm.$visible"></i>
                                    <span  editable-text="custom.fields[0].field" e-name="field">
                                        <%= custom.fields[0].field%>  : </span>
                                    <span e-name="value" editable-text="custom.fields[0].value">   <%= custom.fields[0].value%> </span>
                                    <span class="page-meta ng-scope" ng-hide="editableCustomFieldForm.$visible">
                                        <a ng-click="editableCustomFieldForm.$show()" class="btn-link addAnotherPhone"><i class="fa fa-pencil"></i></a>
                                    </span>
                                    <span class="page-meta ng-scope" ng-hide="editableCustomFieldForm.$visible">
                                        <a ng-click="deleteInfonode(custom.entityKey,'customfields')" class="btn-link addAnotherPhone" ><i class="fa fa-trash-o"></i></a>
                                    </span>
                                     <span ng-show="editableCustomFieldForm.$visible">
                                        <button type="submit" class="btn btn-primary" ng-disabled="editableCustomFieldForm.$waiting">
                                          Save
                                        </button>
                                        <button type="button" class="btn btn-default" ng-disabled="editableCustomFieldForm.$waiting" ng-click="editableCustomFieldForm.$cancel()">
                                          Cancel
                                        </button>
                                      </span>
                                   </form>
                            </li>
                        </ul>
                      </div>
                    </div>
                    <div class="col-md-6">
                      <div class="right-col">
                          <div class="news-blocks blank-card blank-card-blue newsCard">
                              <h3><i class="fa fa-user" style="font-size: 20px;"></i> {{_(' Related contacts')}}</h3>

                              <div class="news-block-tags relatedBlock">
                                  <ul ng-hide="isEmptyArray(opportunity.contacts)" id="slimRelated"
                                      class="list-unstyled contact-infos showList">
                                      <div class="relatedContactsonAccount" ng-repeat="contact in opportunity.contacts"
                                           style="margin-bottom: 5px;position: relative;border-bottom: 1px solid rgb(216, 216, 216);padding-bottom: 3px;"
                                           ng-hide="isEmpty(contact)">
                                          <div style="display: inline-block;float: left;"
                                               class="profile-photo-linkedin">
                                              <img src="<%=contact.profile_img_url || '/static/src/img/avatar_contact.jpg'%>"
                                                   style="width: 73px !important;height: auto !important;">

                                          </div>
                                          <div class="details"
                                               style="  width: calc(100% - 93px); display: inline-block;float: left; padding-left: 15px;"
                                               ng-mouseenter="showDelete = true" ng-mouseleave="showDelete = false">
                                              <div class="onelineItem past-position-title" style="  font-size: 15px;">
                                                  <a target="_blank" href="/#/contacts/show/<%= contact.id %>"><%=contact.firstname%>
                                                      <%=contact.lastname%></a>
                                                  <a ng-click="editbeforedisassociate(contact,opportunity.contacts,'contact')"
                                                     ng-show="showDelete" title="Remove from this opportunity" href=""
                                                     style="text-decoration:none">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<i
                                                          class="fa  fa-chain-broken"></i></a>

                                                  <div class="pull-right">
                                                      <p class=""
                                                         style="line-height: 16px;display: inline-block;float: left;font-size:13px color:#888"
                                                         ng-class="{ 'decisioncheck':contact.is_decesion_maker}">

                                                          Decision maker <span
                                                              ng-hide="contact.is_decesion_maker">? </span>
                                                          <i class="fa fa-check-square decisioncheck"
                                                             ng-click="setDecisionMaker(contact)"
                                                             ng-show="contact.is_decesion_maker"></i>
                                                          <i class="fa fa-square-o " ng-hide="contact.is_decesion_maker"
                                                             ng-click="setDecisionMaker(contact)"></i></p>
                                                  </div>

                                              </div>
                                              <div class="onelineItem past-position-company" style="padding-bottom:1px">
                                                  <%=contact.title%>
                                              </div>
                                              <ul class="list-unstyled contact-infos showList"
                                                  style="padding-left: 0px;">
                                                  <li class="showListItem"
                                                      ng-repeat="phone in contact.phones.items| limitTo:2"
                                                      style="display: inline-block;float: left;">
                                                      <i class="fa fa-phone"
                                                         style="color: #2197f1;font-size: 12px !important;"
                                                         ng-show="$index==0"></i>
                                                      <span ng-show="$index==1"
                                                            style="margin-left:5px;margin-right:2px">|</span>
                                                      <a href="tel:<%=phone.number%>"
                                                         style="color: rgb(96, 96, 96);text-decoration: none;font-size: 12px !important;">
                                                          <%=phone.number%> </a>
                                                  </li>
                                                  <form class="form-inline newLeadForm"
                                                        ng-show="isEmptyArray(contact.phones.items)" role="form"
                                                        style="display: inline-block;float: left;margin-bottom: 0px;">
                                                      <div class="input-icon">
                                                          <i class="fa fa-phone"
                                                             style="margin-top: 5px;margin-bottom: 0px;border: none;color: rgb(33, 151, 241);margin-left: 0px;font-size: 12px !important;"></i>
                                                          <input type="text" class="form-control"
                                                                 ng-enter="addPhoneToContact(contact.phone,contact)"
                                                                 ng-blur="addPhoneToContact(contact.phone,contact)"
                                                                 id="exampleInputEmail2" ng-model="contact.phone.number"
                                                                 placeholder="Add a number"
                                                                 style="padding-top: 0px;padding-bottom: 0px;height: 20px;border: none;padding-left: 21px !important;font-size: 12px !important;">
                                                      </div>
                                                  </form>
                                                  <div class="clearfix"></div>
                                              </ul>
                                              <ul class="list-unstyled contact-infos showList"
                                                  style="padding-left: 0px;">
                                                  <li class="showListItem"
                                                      ng-repeat="email in contact.emails.items| limitTo:1"
                                                      style="display: inline-block;float: left;">
                                                      <i class="fa fa-envelope"
                                                         style="color: #2197f1;font-size: 12px !important;"></i>
                                                      <a ng-click="gotosendMail(email.email)"
                                                         style="color: rgb(96, 96, 96);text-decoration: none;cursor:pointer;font-size: 12px !important;">
                                                          <%=email.email %>
                                                      </a>
                                                  </li>
                                                  <form ng-show="isEmptyArray(contact.emails.items)"
                                                        class="form-inline newLeadForm" role="form"
                                                        style="display: inline-block;float: left;margin-bottom: 0px;">
                                                      <div class="input-icon">
                                                          <i class="fa fa-envelope"
                                                             style="margin-top: 5px;margin-bottom: 0px;border: none;color: rgb(33, 151, 241);margin-left: 0px;font-size: 12px !important;"></i>
                                                          <input ng-blur="addEmailToContact(contact.email,contact)"
                                                                 ng-enter="addEmailToContact(contact.email,contact)"
                                                                 type="email"
                                                                 class="form-control ng-pristine ng-valid ng-valid-email"
                                                                 id="exampleInputEmail2" ng-model="contact.email.email"
                                                                 placeholder="Add an email"
                                                                 style="padding-top: 0px;padding-bottom: 0px;height: 20px;border: none;padding-left: 21px !important;font-size: 12px !important;">
                                                      </div>
                                                  </form>
                                                  <div class="clearfix"></div>
                                              </ul>
                                              <ul class="socialLinks"
                                                  style="list-style: none;padding-left: 0px;top: 0px;right: 0px;z-index: 3; max-height:116px;overflow: auto;margin-bottom: 0px;  position: absolute;">
                                                  <li ng-repeat="sociallink in contact.sociallinks" class="socialItem"
                                                      style="padding-bottom: 5px;">
                                                      <div class="cont">
                                                          <a href=""
                                                             onclick="window.open('<%=prepareUrl(sociallink.url)%>','winname','width=700,height=550')"
                                                             style="display: inline-block;   float: left;"><img
                                                                  width="16"
                                                                  src="/static/src/img/social_icons/<%=urlSource(sociallink.url)%>.png"></a>

                                                          <div class="clearfix"></div>
                                          </div>
                                                  </li>
                                              </ul>
                                          </div>
                                      <div class="clearfix"></div>
                                      </div>
                                  </ul>
                                  <div class="" ng-class="{ 'has-error': oppo_err.account && oppo_err.contact }"
                                       style="margin-bottom:15px">
                                      <div class="" style="margin-top:10px">
                                          <input type="text" required ng-model="searchRelatedContactQuery"
                                                 typeahead-loading="conSearchLoading"
                                                 ng-class="{'spinner':conSearchLoading}"
                                                 typeahead="relatedContactResult as relatedContactResult.firstname + ' '+  relatedContactResult.lastname for relatedContactResult in  getResults($viewValue,'/crmengine/v1/contacts/search')| filter:$viewValue | limitTo:10"
                                                 typeahead-on-select="selectContact()" class="form-control"
                                                 placeholder="{{_('Add an existing contact ...')}}">
                                      </div>
                                  </div>
                                  <a href="" ng-click="newRelatedContact=true" style="color: rgb(209, 38, 16);"> + <i
                                          class="fa fa-user"></i> or add a new contact</a>

                                  <form class=" relatedNewForm slimForm ng-pristine ng-invalid ng-invalid-required"
                                        ng-show="newRelatedContact">
                                      <div class="formElements">
                                          <div class="row">
                                              <div class="col-md-6 firstNameLeft">
                                                  <input ng-model="currentContact.firstname" type="text" id="firstName"
                                                         class="form-control" placeholder="{{_('First Name')}}">
                                              </div>
                                              <!--/span-->
                                              <div class="col-md-6 lastNameRight">
                                                  <input ng-model="currentContact.lastname" type="text" id="lastName"
                                                         class="form-control" placeholder="{{_('Last Name')}}"
                                                         ng-blur="getLinkedinProfile();getTwitterProfile()">
                                              </div>
                                              <!--/span-->
                                          </div>
                                          <div class="row">
                                              <div class="col-md-12">
                                                  <div class="input-icon margin-top-10">
                                                      <i class="fa fa-briefcase"></i>
                                                      <input ng-model="currentContact.title" type="text"
                                                             class="form-control" placeholder="{{_('Title')}}">
                                                  </div>
                                              </div>
                                          </div>
                                          <div class="row">
                                              <div class="col-md-12">
                                                  <div class="input-icon  margin-top-10">
                                                      <i class="fa fa-phone"></i>
                                                      <input ng-model="currentContact.phone" type="text"
                                                             class="form-control" placeholder="{{_('Phone')}}">
                                                  </div>
                                              </div>
                                          </div>
                                          <div class="row">
                                              <div class="col-md-12">
                                                  <div class="input-icon  margin-top-10">
                                                      <i class="fa fa-envelope"></i>
                                                      <input ng-model="currentContact.email" type="text"
                                                             class="form-control" placeholder="{{_('Email')}}">
                                      </div>
                                              </div>
                                          </div>
                                          <!-- begin address-->
                                          <ul class="list-unstyled contact-infos infoslist">
                                              <li ng-repeat="address in addresses">
                                                  <a ng-click="setLocation(address)" ng-show="address.lng" href=""
                                                     style="color:blue"><i class="fa  fa-map-marker"></i></a><i
                                                      style="color:red" ng-hide="address.lat"
                                                      class="fa fa-exclamation"></i>
                                                <span editable-text="address.country"
                                                      onbeforesave="inlinePatch('Infonode','addresses', 'street',address.entityKey,$data)"
                                                      ng-show="address.street"><%=address.street%>, </span>
                                                <span editable-text="address.city"
                                                      onbeforesave="inlinePatch('Infonode','addresses', 'city',address.entityKey,$data)"
                                                      ng-show="address.city"><%=address.city%>, </span>
                                                <span editable-text="address.state"
                                                      onbeforesave="inlinePatch('Infonode','addresses', 'state',address.entityKey,$data)"
                                                      ng-show="address.state"><%=address.state%>, </span>
                                                <span editable-text="address.country"
                                                      onbeforesave="inlinePatch('Infonode','addresses', 'country',address.entityKey,$data)"
                                                      ng-show="address.country"><%=address.country%></span>
                                                  <span ng-show="address.formatted"><%=address.formatted%></span>
                                                  <button type="button" class="close closeContactForm" tabindex='-1'
                                                          ng-click="deleteInfos(addresses,$index)"
                                                          data-dismiss="alert"></button>
                                              </li>
                                              <!-- <a href="#addressmodal"
                                                 class="btn-link addAnotherPhone"
                                                 data-toggle="modal">
                                                 <i class="icon-plus"></i>{{_('Add a new address')}}
                                               </a>
                                               </li>-->
                                          </ul>
                                          <div class="row">
                                              <div class="col-md-12">
                                                  <div class="input-icon  margin-top-10">
                                                      <i class="fa  fa-map-marker"></i>
                                                      <input id="relatedContactAddress"
                                                             ng-model="currentContact.address" type="text"
                                                             class="form-control" placeholder="{{_('Address')}}">
                                                  </div>
                                              </div>
                                          </div>
                                    </div>
                                      <div class="row">
                                          <div class="col-md-12 margin-top-10">
                                              <p>
                                                  <button type="button" ng-click="addNewRelatedContact(currentContact)"
                                                          class="btn blue btn-sm pull-right btn-inline"><i
                                                          class="fa fa-user"></i>&nbsp;{{_('Add')}}
                                                  </button>
                                              </p>

                                          </div>
                                      </div>
                                  </form>
                              </div>
                          </div>


                          <div class="news-blocks blank-card blank-card-yellow newsCard">
                    <h3 style="margin-top:0px; margin-bottom: 20px;">
                      <i class="fa fa-edit" style="  font-size: 24px;"></i>{{_(' Notes')}}
                     </h3>
                    <div class="news-block-tags">
                       <ul class="chats">
                        <li class="in" ng-repeat="topic in topics" id="topic_<%=$index%>">
                            <img class="avatar" alt="" ng-src="<%= topic.last_updater.photo%>" />
                            <div class="message">
                                <span class="arrow"></span>
                                <a href="#" class="name">
                                    <%= topic.last_updater.display_name%>
                                </a>
                                <span class="datetime">
                                    at <%=topic.updated_at | date:'MM-dd-yyyy - HH:mm:ss '  %>
                                </span>
                                <span class="body">
                                    <a href="<%=getTopicUrl(topic.topic_kind,topic.id)%>" class="discussion-content"><strong class="ng-binding">
                                            <a href="#/notes/show/<%= topic.id%>"><%= topic.title%></a> </strong> - <span class="excerpt ng-binding" ng-bind-html-unsafe="topic.excerpt"></span><span class="chat-meta pull-right" ng-show="topic.comments"><i class="icon-comment"></i> <a href="#/notes/show/<%= topic.id%>"> <%= topic.comments%> </a> {{_('comments')}}</span>
                                    </a>
                                </span>
                            </div>
                        </li>
                    </ul>
                        <div class="row">
                        <div class="col-md-12  margin-bottom-10">
                            <!--<p class⁼"lead"="">
                               {{_('To add an outside email to this account, forward or BCC to:')}}
                               <a href="mailto:111054727630979006769@gcdc2013-iogrow.appspotmail.com">
                                    111054727630979006769@gcdc2013-iogrow.appspotmail.com
                                </a>
                                <br>
                                {{_('Or just add notes to remember what\'s important.')}}
                                <br>
                            </p>-->
                            <form id="addNote" class="ng-pristine ng-valid">
                                <div class="form-group">
                                    <input class="form-control ng-pristine ng-valid" autofocus="" type="text" placeholder="{{_('Title')}}" id="messageSubject" ng-model="note.title">
                                </div>
                                <div class="form-group">
                                    <textarea id="noteBody" class="form-control ng-pristine ng-valid" rows="3" ng-model="note.content" placeholder="{{_('Note ...')}}"></textarea>
                                </div>
                                <div class="pull-right">
                                    <input ng-disabled="isLoading || !note.title" ng-click="addNote(note)"  type="submit" class="btn blue" value="Add this note">
                                </div>
                            </form>
                        </div>
                    </div>                                                    
                    </div>

                </div>
                <div class="news-blocks blank-card blank-card-yellow newsCard hidden">
                        <a ng-click="showPriceForm=true" ng-hide="showPriceForm" class="btn-link pull-right addAnotherPhone" data-toggle="modal"><i class="fa fa-pencil"></i> Edit </a> 

                        <h3>{{ _('Opportunity Details')}}</h3>
                        <div class="stage-chart-block">
                          <div class="col-md-5">
                            <div class="stage" >
                              <div easypiechart class="chart"  options="chartOptions" percent="opportunity.current_stage.probability"></div>
                              <div class="oppStage">
                                <span><%=opportunity.current_stage.name%></span><br>
                                <span><%=opportunity.current_stage.probability%> %</span>
                              </div>
                            </div>
                          </div>
                           <div class="oppPrice col-md-7 ">
                            <div class="form-group currencyForm" ng-show="showPriceForm">
                              <div class="col-md-12 margin-bottom-10">
                                  <input type="text" required id="id_name" class="form-control" placeholder="{{_('Opportunity amount...')}}" ng-model="opportunity.amount_per_unit " ng-blur="updateOpportunityPrice()">
                               </div>
                              <div class="col-md-12 margin-bottom-10">
                               <select  class="form-control" ng-model="opportunity.currency" ng-change="updateOpportunityPrice()">
                                <option value="USD" selected>$ - USD</option>
                                <option value="EUR">€ - EUR</option>
                                <option value="CAD">$ - CAD</option>
                                <option value="GBP">£ - GBP</option>
                                <option value="AUD">$ - AUD</option>
                                <option value="">---</option>
                                <option value="AED">د.إ - AED</option>
                                <option value="ANG">ƒ - ANG</option>
                                <option value="AOA">AOA - AOA</option>
                                <option value="ARS">$ - ARS</option>
                                <option value="BAM">KM - BAM</option>
                                <option value="BBD">$ - BBD</option>
                                <option value="BGL">лв - BGL</option>
                                <option value="BHD">BD - BHD</option>
                                <option value="BND">$ - BND</option>
                                <option value="BRL">R$ - BRL</option>
                                <option value="BTC">฿ - BTC</option>
                                <option value="CHF">Fr - CHF</option>
                                <option value="CLF">UF - CLF</option>
                                <option value="CLP">$ - CLP</option>
                                <option value="CNY">¥ - CNY</option>
                                <option value="COP">$ - COP</option>
                                <option value="CRC">₡ - CRC</option>
                                <option value="CZK">Kč - CZK</option>
                                <option value="DKK">kr - DKK</option>
                                <option value="EEK">KR - EEK</option>
                                <option value="EGP">E£ - EGP</option>
                                <option value="FJD">FJ$ - FJD</option>
                                <option value="GTQ">Q - GTQ</option>
                                <option value="HKD">$ - HKD</option>
                                <option value="HRK">kn  - HRK</option>
                                <option value="HUF">Ft - HUF</option>
                                <option value="IDR">Rp - IDR</option>
                                <option value="ILS">₪ - ILS</option>
                                <option value="INR">₨ - INR</option>
                                <option value="IRR">ریال - IRR</option>
                                <option value="ISK">kr - ISK</option>
                                <option value="JOD">د.ا - JOD</option>
                                <option value="JPY">¥ - JPY</option>
                                <option value="KES">KSh - KES</option>
                                <option value="KRW">₩ - KRW</option>
                                <option value="KWD">KD - KWD</option>
                                <option value="KYD">$ - KYD</option>
                                <option value="LTL">Lt - LTL</option>
                                <option value="LVL">Ls - LVL</option>
                                <option value="MAD">د.م. - MAD</option>
                                <option value="MVR">Rf - MVR</option>
                                <option value="MXN">$ - MXN</option>
                                <option value="MYR">RM - MYR</option>
                                <option value="NGN">₦ - NGN</option>
                                <option value="NOK">kr - NOK</option>
                                <option value="NZD">$ - NZD</option>
                                <option value="OMR">ر.ع - OMR</option>
                                <option value="PEN">S/. - PEN</option>
                                <option value="PHP">₱ - PHP</option>
                                <option value="PLN">zł - PLN</option>
                                <option value="QAR">ر.ق - QAR</option>
                                <option value="RON">L - RON</option>
                                <option value="RUB">руб. - RUB</option>
                                <option value="SAR">ر.س - SAR</option>
                                <option value="SEK">kr - SEK</option>
                                <option value="SGD">$ - SGD</option>
                                <option value="THB">฿ - THB</option>
                                <option value="TRY">TL - TRY</option>
                                <option value="TTD">$ - TTD</option>
                                <option value="TWD">$ - TWD</option>
                                <option value="UAH">₴ - UAH</option>
                                <option value="VEF">Bs F - VEF</option>
                                <option value="VND">₫ - VND</option>
                                <option value="XCD">$ - XCD</option>
                                <option value="ZAR">R - ZAR</option>
                                <option value="DZD">د.ج- DZD</option>
                              </select>
                              </div>
                                <div class="col-md-12 margin-bottom-10">
                                    <select   ng-click="showPriceForm=true" class="form-control" ng-model="opportunity.duration_unit">
                                        <option value="fixed">{{ _('Fixed bid')}}</option>
                                        <option value="hour">{{ _('Per hour')}}</option>
                                        <option value="month">{{ _('Per month')}}</option>
                                        <option value="year">{{ _('Per year')}}</option>
                                    </select>
                                </div>
                                <div ng-hide="opportunity.duration_unit=='fixed'" class="col-md-12 margin-bottom-10">
                                   <input ng-click="showPriceForm=true"  type="text" pattern="\d*"  required id="" class="form-control" ng-model="opportunity.duration">
                                </div>
                                <div class="col-md-12 margin-bottom-10">
                                  <div class="pull-right">
                                   <button class="btn blue btn-sm" ng-click="updateOpportunityPrice()">{{_("Ok")}}</button>
                                   <button class="btn btn-sm" ng-click="showPriceForm=falsee">{{_("Cancel")}}</button>
                                  </div>

                                </div>
                            </div>
                              <span ng-hide="showPriceForm" ng-click="showPriceForm=true"><%= opportunity.currency %></span>
                              <span ng-hide="showPriceForm" ng-click="showPriceForm=true"><%= opportunity.amount_total | customCurrency:"":",":".":0 %></span>

                              <p class="amount-details" ng-click="showPriceForm=true"  ng-show="opportunity.duration_unit!='fixed'">
                                  <%= opportunity.duration %> × <%= opportunity.amount_per_unit| customCurrency:"":",":".":0 %>/<%= opportunity.duration_unit %>
                              </p>
                              <div class="oppEstDate">
                                 {{ _('Estimated close date')}}
                              </div>
                             <!-- <div class="oppEstDate" >
                                <span ng-hide="showStartsCalendar" ng-click="showStartsCalendar=true"><i class="fa fa-calendar"></i>
                                <%=opportunity.closed_date | date:'yyyy-MM-dd - HH:mm:ss '%></span>
                                <div ng-show="showStartsCalendar" class="input-icon">
                                     <i class="fa fa-calendar"></i>
                                     <input cdatetimepicker data-model="opportunity.closed_date" type="text" class="form-control" placeholder="{{ _('Click to change the estimated date')}}" value="" id="leadEventStartsAt">
                                     </div>
                              </div>
                              <span  class="margin-bottom-15">
                                <datetimepick ng-model='opportunity.closed_date'  label-format='EEEE, MMMM d, yyyy'></datetimepick>
                              </span>-->

                           </div>

                        </div>
                        <div class="row padding-bottom-15">
                          <div class="col-md-12 margin-opp">
                            <div class="form-group">

                                <div class="col-md-12">

                                  <select ng-model="opportunity.current_stage" ng-change="updateOpportunityStage()" ng-options="opps as opps.name + ' - ( ' + opps.probability + '% )'   for opps in opportunitystages track by opps.probability" class="form-control">
                                  </select>
                                </div>
                            </div>
                          </div>
                        </div>
                      </div>

                      </div>
                    </div>
                  </div>
                </div>
                <div class="tab-pane active" id="tab_1_7" ng-show="selectedTab == 7" style="display: none;">

                               <div class="row cards-container iodrive">
                                <div class="col-md-12">
                                  <div class="row">
                                   <!-- ngRepeat: attachment in documents -->
                                         <div class="col-md-12 waterfall" ng-hide="blankStateaccount">
                                          <div ng-repeat="attachment in documents" class="cardElement cusCardElement" style="min-height: 76px;">
                                            <div class="customCheckbox cusCheckOnCard checkboxOnSmallScreen ">  
                                                  <input  title="Select document" type="checkbox" ng-checked="isSelectedDoc(attachment)" ng-click="selectDocWithCheck($event,$index,attachment)" id="docCard_<%= $index %>">
                                                  <label for="docCard_<%= $index %>" class="labelElement">
                                                    <span class="check"></span>
                                                    <span class="box"></span>
                                                  </label>  
                                              </div>
                                              <div class="detailsSection">
                                                  <div class="head">
                                                      <div class="pic">
                                                          <a href="<%= attachment.embedLink %>"
                                                             class="startup-link" title="attachment.title">
                                                              <img alt="attachment.title"
                                                                   class="google-drive-icon img-responsive img-thumbnail"
                                                                   ng-src="/static/src/img/google_drive/<%=attachment.mimeType%>.png" ng-class="{ 'documentimgsize': attachment.mimeType=='image/jpeg'||attachment.mimeType=='image/png'||attachment.mimeType=='image/x-icon'}">
                                                          </a>
                                                      </div>
                                                      <div class="text">
                                                          <div class="name"><a href="<%= prepareEmbedLink(attachment.embedLink)%>" target="_blank" title="<%=attachment.title%>" class="profile-link"><span><%=attachment.title%></span></a>
                                                          </div>
                                                          <div class="pitch">
                                                              <span style="font-size: 11px;color: gray;">
                                                                  <%=attachment.created_at| date:'dd MMMM yyyy'%>
                                                              </span>
                                                          </div>                                        
                                                      </div>
                                                      <div class="clearfix"></div>
                                                  </div>
                                              </div>
                                          </div>
                                         <!--blank stat-->
                                        <div class="clearfix"></div>
                                    </div><!--/inner-cards-container-->
                                     <div ng-show="blankStatdocuments" class="col-md-12 responsive" data-tablet="span6" data-desktop="span12">
                                             <div class="dashboard-stat cards">
                                                 <div class="blank_slate_arrow"></div>
                                                 <div class=" thumbnail blank_slate_body">
                                                    <img src="/static/src/img/documents_blanks.png" class="img-responsive">
                                                      <p class="lead">{{ _('Manage easily your documments using Google drive')}}</p>
                                                 </div>
                                             </div>
                                         </div>
                                    </div>

                                    </div>

                                  </div>

                            </div>
                <div class="tab-pane active" id="tab_1_4" ng-show="selectedTab == 8">

                         <div class="showPage">
                           <div class="row">
                             <div class="col-md-12  margin-bottom-10">
                          <p class⁼"lead"=""><strong>{{ _('Send an Email to :')}}</strong> </p>
                          <form  class="ng-pristine ng-valid">
                                            <div class="form-group">
                                            <input required class="form-control ng-pristine ng-valid" autofocus type="text" placeholder="{{_('To')}}" id="messageSubject" ng-model="email.to">
                                            </div>
                                            <div class="form-group">
                                            <input class="form-control ng-pristine ng-valid" autofocus type="text" placeholder="{{_('CC')}}" id="messageSubject" ng-model="email.cc">
                                            </div>
                                            <div class="form-group">
                                            <input class="form-control ng-pristine ng-valid" autofocus type="text" placeholder="{{_('BCC')}}" id="messageSubject" ng-model="email.bcc">
                                            </div>
                                            <div class="form-group">
                                             <input  required class="form-control ng-pristine ng-valid" autofocus type="text" placeholder="{{_('Add a subject')}}" id="messageSubject" ng-model="email.subject">
                                             </div>
                                            <div class="form-group">
                                            <textarea id="some-textarea" placeholder="{{_('Enter text ...')}}" id="noteBody" class="form-control ng-pristine ng-valid" rows="7" ng-model="email.body"></textarea>
                                             </div>
                                             <div class="form-group">
                                                        <a href="#" data-toggle="modal" ng-click="showAttachFilesPicker()"><i class="fa fa-file"></i> {{_('Attach files')}}</a>
                                                        <ul class="list-unstyled">
                                                            <li ng-repeat="file in sendWithAttachments">
                                                                <%= file.title %>
                                                            </li>
                                                        </ul>
                                                    </div>
                                         <div class="pull-right">

                                            <input   ng-click="sendEmail(email)" ng-disabled="isLoading" type="submit" class="btn green" value="{{_('Send')}}">


                                          </div>
                            </form>
                          </div>
                        </div>
                      </div>
                  </div>
                </div>

              </div>

            </div>
          </div>
        </div>
      </div>



<!-- tasks cards -->

   <div class="col-md-3 tasks-col">
            <div class="row">
                        <div class="col-md-12">
                             <div class="portlet showPage rightCardContent">
                                  <div class="col-md-12">
                                            <ul class="list-unstyled metaDataList">
                                              <li ng-show="account.account_type">
                                                <span>
                                                    {{_('Type:')}}
                                                    <a class="tag ng-binding" href="/#/search/type:Account #<%= account.account_type %>">
                                                        #<%= account.account_type %>
                                                    </a>
                                                </span>
                                              </li>
                                              <li ng-show="account.industry">
                                                <span>
                                                    {{_('Industry:')}}
                                                    <a class="tag ng-binding" href="/#/search/type:Account  #<%= account.industry %>">
                                                        #<%= account.industry %>
                                                    </a>
                                                </span>
                                              </li>
                                              <li ng-show="opportunity.owner">
                                                  <div class="btn-group">
                                                      <span class="title">
                                                          <i class="fa fa-user"></i>
                                                         {{ _('Owner:') }}
                                                      </span>
                                                      <span ng-hide="(showEdit)&&(opportunity.owner.google_user_id=={{ME}}||{{is_admin}})" >
                                                            <%= opportunity.owner.google_display_name %>
                                                      </span>
                                                      <a ng-show="(showEdit)&&(opportunity.owner.google_user_id=={{ME}}||{{is_admin}})"  style="  color: #262626;text-decoration: none; margin-left:0px" href="#"
                                                         data-toggle="dropdown" style="margin-right:0px">
                                                          
                                                          <span>
                                                            <%= opportunity.owner.google_display_name %>
                                                          </span>
                                                          <i class="icon-angle-down fa fa-angle-down"></i>
                                                      </a>
                                                      <ul class="dropdown-menu" ng-show="(showEdit)&&(opportunity.owner.google_user_id=={{ME}}||{{is_admin}})" >
                                                          <li ng-repeat="user in users">
                                                              <a ng-click="inlinePatch('Opportunity','', 'owner',opportunity.id,user.google_user_id)">
                                                                  <%=user.google_display_name%>
                                                              </a>
                                                          </li>
                                                      </ul>
                                                  </div>
                                              </li>
                                              <li class="" ng-show="opportunity.owner.google_user_id=={{ ME }}||{{ is_admin }}">
                                                <div class="btn-group">
                                                    <span class="title">
                                                           <i class="fa fa-key"></i>
                                                             {{ _(' Access : ') }}
                                                    </span>
                                                    <span ng-hide="showEdit">
                                                           <%=opportunity.access%> 
                                                    </span>
                                                    <a ng-show="showEdit" style="  color: #262626;text-decoration: none; margin-left:0px" href="#"
                                                       data-toggle="dropdown" style="margin-right:0px">
                                                       <span>
                                                           <%=opportunity.access%> 
                                                       </span>
                                                       
                                                        <i class="icon-angle-down fa fa-angle-down"></i>
                                                    </a>
                                                    <ul class="dropdown-menu">
                                                        <li>
                                                            <a ng-click="opportunity.access='public';share({{ ME }})" data-toggle="modal">
                                                                {{ _('Public') }}
                                                            </a>
                                                        </li>
                                                        <li>
                                                            <a ng-click="opportunity.access='private';share({{ ME }})" data-toggle="modal">
                                                                {{ _('Private') }}
                                                            </a>
                                                        </li>
                                                    </ul>
                                                </div>
                                            </li>
                                              <li>
                                                <span class="title">
                                                    <i class="fa fa-clock-o"></i>
                                                    {{ _('Last updated:') }}
                                                </span>
                                                <span class="title" >
                                                    <%=fromNow(opportunity.updated_at)%>
                                                </span>
                                              </li>
                                            </ul>
                                        </div>
                                        <div class="col-md-12" ng-hide="isEmptyArray(opportunity.tags)">
                                              <hr class="sm-hr">
                                              <div class="relatedTags tags-section">
                                                  <div class="section-content">
                                                      <span class="pull-left"><i class="fa fa-tags"></i>{{_('Tags')}}: </span>
                                                      <!-- ngRepeat: tag in account.tags -->
                                                      <div ng-repeat="tag in opportunity.tags">
                                                          <span class="pull-left task-label task-tag badge ng-scope ng-binding" style="background-color: <%=tag.color%>;color:<%=idealTextColor(tag.color)%>;">
                                                              <a href="" ng-click="removeTag(tag,$index)" class="removeRelatedTag select2-search-choice-close" ></a>
                                                              <%= tag.name %>
                                                          </span>
                                                      </div>
                                                  </div>
                                              </div>
                                      </div>
                                <div class="clearfix"></div>
                              </div>
                        </div>
            </div>
            <div class="row">
                <div class="col-md-12">
                     <div class="portlet showPage rightCardContent">
                <div class="portlet-title line">
                  <div class="caption"> <i class="fa fa-check"></i>{{_('Tasks')}} </div>

                </div>
                <div class="newContactform portlet-body" id="chats">
                   <ul id="tasks" class="list-unstyled lead_related_events" ng-hide="newEventform">
                      <li ng-repeat="task in tasks" id="event_<%=$index%>" class="relatedEventItem" ng-mouseenter="showDeleteBtn = true" ng-mouseleave="showDeleteBtn = false">
                        <div class="event-container">
                          <div class="showDescription">
                            <span class="relatedEventTitle">
                               <a href="/#/tasks/show/<%=task.id%>" class="discussion-content">
                                 <%= task.title%>
                               </a>
                            </span>
                            <a class="pull-right relatedEventMoreBtn">
                              <i class="fa fa-chevron-right" ng-hide="showDetails" ng-click="showDetails=true"></i>
                              <i class="fa fa-chevron-down" ng-show="showDetails" ng-click="showDetails=false"></i>
                            </a>
                            <a class="pull-left relatedEventDeleteBtn" ng-show="showDeleteBtn" ng-click="deleteTask(task)">
                              <i class="fa fa fa-times-circle"></i>
                            </a>
                            <span class="relatedEventStartsAt pull-right" ng-hide="showDetails" ng-show="task.due" title="<%= task.due| date:'yyyy-MM-dd '%>">
                                  <%= task.due | date:'dd MMM'%>
                            </span>
                          </div>
                          <div class="moreDetails row" ng-show="showDetails">
                          <!--  <div class="col-md-6 col-xs-6 event-schedule">
                                <span class=""><i class="fa fa-calendar"></i>
                                 <%= task.due | date:'dd MMM'%> </span>
                            </div>
                            <div class="col-md-6 col-xs-6 event-schedule">
                               <span class="">
                                  <i class="fa fa-bell-o"></i>
                                  <%= task.reminder | date:'dd MMM'%>
                                </span>
                            </div>
                            <div class="col-md-12">
                               <span class="">
                                  <i class="fa fa-map-marker"></i>
                                  <%= event.where %>-->
                                <!--</span>
                            </div>-->
                          </div>
                        </div>
                      </li>
                  </ul>
                  <form class=" slimForm ng-pristine ng-invalid ng-invalid-required">
                      <div class="formElements newTaskToLead" ng-show="newTaskform">
                                <div class="row">
                                  <div class="col-md-12 margin-bottom-10">
                                      <input ng-model="newTask.title" type="text" id="taskName" class="form-control" placeholder="{{_('Tilte')}}">
                                  </div>
                                  <!--/span-->
                                </div>
                                <div class="row">
                                    <div class="col-md-12 margin-bottom-10">
                                      <div class="input-icon ">
                                        <i class="fa fa-calendar"></i>
                                          <input cdatetimepicker data-model="newTask.due" type="text" class="form-control" placeholder="{{_('Add a due date')}}" value="" id="leadEventStartsAt">
                                      </div>
                                    </div>
                                </div>
                                <div class="row">
                                    <div class="col-md-12">
                                        <div class='assigneeMemberToTask' >
                                            <div class="input-icon ">
                                              <i class="fa fa-user"></i>
                                              <input type="text" ng-model="user" typeahead="user as user.google_display_name + ' <' + user.email + '>' for user in users | filter:$viewValue | limitTo:8" typeahead-on-select="selectMemberToTask()" class="form-control" placeholder="{{ _('Enter name or email addresse to add people to this group')}}">
                                            </div>
                                            <div id="assigeeList" class="list-group" ng-hide="selected_members == []">
                                                <div ng-show="true" class="invitation list-group-item" ng-repeat="selected_us in selected_members">
                                                    <button type="button" class="close" ng-click="unselectMember($index)" data-dismiss="alert"></button>
                                                    <img class="google-avatar" ng-src="selected_us.google_public_profile_photo_url"/>
                                                    <strong> <%= selected_us.google_display_name %></strong>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                      </div>
                      <div class="row">
                          <div class="col-md-12 margin-top-10">
                              <p><span ng-hide="newTaskform">{{_('Add New Task')}}</span><button type="button" ng-click="addTask(newTask)" class="btn blue btn-sm pull-right btn-inline">{{_('Add')}}</button><button type="button" ng-click="closeTaskForm(newTask)" ng-show="newTaskform" class="cancelEventBtn btn btn-default btn-sm pull-right btn-inline">{{ _('Cancel')}}</button></p>

                          </div>
                      </div>
                  </form>
                </div>
              </div>
                </div>
            </div>
      <!-- $ Events -->
      <div class="row">
      <div class="col-md-12">
          <div class="portlet showPage rightCardContent">
                <div class="portlet-title line">
                  <div class="caption"> <i class="fa fa-calendar"></i>{{_('Events')}} </div>

                </div>
                <div class="newContactform portlet-body" id="chats">
                   <ul id="tasks" class="list-unstyled lead_related_events" ng-hide="newEventform">
                      <li ng-repeat="event in events" id="event_<%=$index%>" class="relatedEventItem" ng-mouseenter="showDeleteBtn = true" ng-mouseleave="showDeleteBtn = false">
                        <div class="event-container">
                          <div class="showDescription">
                            <span class="relatedEventTitle">
                              <a href="/#/events/show/<%=event.id%>" class="">
                                <%= event.title%>
                              </a>
                            </span>
                            <a class="pull-right relatedEventMoreBtn">
                              <i class="fa fa-chevron-right" ng-hide="showDetails" ng-click="showDetails=true"></i>
                              <i class="fa fa-chevron-down" ng-show="showDetails" ng-click="showDetails=false"></i>
                            </a>
                            <a class="pull-left relatedEventDeleteBtn" ng-show="showDeleteBtn" ng-click="deleteEvent(event)">
                              <i class="fa fa fa-times-circle"></i>
                            </a>
                            <span class="relatedEventStartsAt pull-right" ng-hide="showDetails" ng-show="event.starts_at" title="<%= event.starts_at | date:'yyyy-MM-dd '%>">
                                  <%= event.starts_at | date:'dd MMM'%>
                            </span>
                          </div>
                          <div class="moreDetails row" ng-show="showDetails">
                            <div class="col-md-5 col-xs-5 event-schedule">
                                <span class=""><i class="fa fa-calendar"></i>
                                <%= event.starts_at | date:'dd MMM'%> </span>
                            </div>
                            <div class="col-md-2 col-xs-2 event-schedule">
                                <i class="fa fa-chevron-right"></i>
                            </div>
                            <div class="col-md-5 col-xs-5 event-schedule">
                               <span class="">
                                  <i class="fa fa-calendar"></i>
                                  <%= event.ends_at | date:'dd MMM'%>
                                </span>
                            </div>
                            <div class="col-md-12">
                               <span class="">
                                  <i class="fa fa-map-marker"></i>
                                  <%= event.where %>
                                </span>
                            </div>
                          </div>
                        </div>
                      </li>
                  </ul>
                  <form class=" slimForm ng-pristine ng-invalid ng-invalid-required">
             <!--      <div class="formElements newEventToLead" ng-show="newEventform">
                            <div class="row">
                              <div class="col-md-12 margin-bottom-10">
                                  <input ng-model="ioevent.title" type="text" id="taskName" class="form-control" placeholder="{{_('Event tilte')}}">
                              </div>
                              
                            </div>
                            {{_('All day')}} <input type="checkbox" ng-model="allday"/>
                              
                              <div class="row" ng-show="allday">
                                <div class="col-md-12 margin-bottom-10">
                                       <div class="input-icon ">
                                        <i class="fa fa-calendar"></i>
                                       <input cusdatetimepicker data-model="ioevent.starts_at_allday" type="text" class="form-control" placeholder="{{_('When?')}}" value="" id="leadEventStartsAt">
                                      </div>
                                </div>
                            </div>
                              

                            <div class="row" ng-hide="allday">
                                <div class="col-md-12 margin-bottom-10">
                                      <div class="input-icon">
                                        <i class="fa fa-calendar"></i>
                                        <input cusdatetimepicker data-model="ioevent.starts_at" type="text" class="form-control" placeholder="{{_('From')}}" value="" id="leadEventStartsAt">
                                      </div>

                                </div>
                            </div>
                            <div class="row" ng-hide="allday">
                                <div class="col-md-12 margin-bottom-10">
                                       <div class="input-icon ">
                                        <i class="fa fa-calendar"></i>
                                       <input cusdatetimepicker data-model="ioevent.ends_at" type="text" class="form-control" placeholder="{{_('To')}}" value="" id="leadEventStartsAt">
                                      </div>
                                </div>
                            </div>
                            
                            <div class="row">
                              <div class="col-md-12 margin-bottom-10">
                                  <input ng-model="ioevent.where" type="text" id="taskName" class="form-control" placeholder="{{_('Where ?')}}">
                              </div>
                             
                            </div>
                  </div> -->
                  <div class="row">
                      <div class="col-md-12 margin-top-10">
                          <p class="newEventText"><span ng-hide="newEventform">{{_('Add New Event')}}</span>
                          <button type="button" ng-click="showAddEventPopup()" class="btn red btn-sm pull-right btn-inline">{{_('Add')}}</button>
                      <!--     <button type="button" ng-click="closeEventForm(ioevent)" ng-show="newEventform" class="cancelEventBtn btn btn-default btn-sm pull-right btn-inline">{{_('Cancel')}}</button> -->
                          </p>
                      </div>
                  </div>
              </form>
                </div>
              </div>
        </div>
        <div class="col-md-12">

        </div>
      </div>
      <script type="text/javascript">
          $('.lead_related_events').slimScroll({
                                    height: '160px'
                                });

      </script>
        </div>
    </div>
             <div id="EditCaseModal" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
             <div class="modal-dialog">
              <div class="modal-content">
              <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                <h3 id="myModalLabel" class="modal-title">{{_("Edit Case")}}</h3>
              </div>

              <div class="modal-body">
                 <form id="editCase" name="editlead" ng-submit="updatCasetHeader(casee)" class="form-horizontal">


                  <div class="form-group">
                        <label  class="required col-md-3 control-label">{{_("Name")}} </label>

                        <div class="col-md-9">
                          <input type="text" class="form-control" required id="id_lastname" ng-model="casee.name">

                        </div>
                    </div>
                    <div class="form-group">
                        <label  class="required col-md-3 control-label">{{_("Priority")}}</label>

                        <div class="col-md-9">
                          <select class="form-control" ng-model="casee.priority">
                            <option value="1">1 - {{ _('Low')}}</option>
                            <option value="2">2</option>
                            <option value="3">3</option>
                            <option value="4">4</option>
                            <option value="5">5</option>
                            <option value="6">6</option>
                            <option value="7">7</option>
                            <option value="8">8</option>
                            <option value="9">9</option>
                            <option value="10">10 - {{ _('Critical')}}</option>
                          </select>

                        </div>
                    </div>
                    <!--div class="form-group">
                        <label  class="required col-md-3 control-label">{{_("Labels")}} </label>

                        <div class="col-md-9">
                          <input type="text"  class="form-control"  id="id_type_case" ng-model="casee.type_case">

                        </div>
                    </div-->
                 <div class="form-group">
                        <label  class="required col-md-3 control-label">{{_("Status")}} </label>

                        <div class="col-md-9">
                          <select ng-model="status_selected" ng-options="stat.status for stat in casesatuses" class="form-control">
                            <option value=""><%=casee.status%> </option>

                          </select>

                        </div>

                   </div>





              </div>
              <div class="modal-footer">
                <button class="btn" data-dismiss="modal" aria-hidden="true">{{_("Close")}}</button>
                <button  type="submit" class="btn btn-primary addContactNow">{{_("Save")}} </button>
              </div>
               </form>
              </div>
        </div>
      <!-- END PAGE CONTAINER-->
</div>
<div id="sharingSettingsModal" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                <h3 id="myModalLabel" class="modal-title">{{_("Sharing Settings")}}</h3>
            </div>
            <div class="modal-body">
                <form id="addMember" name="addaccount" class="form-horizontal">
                    <p>{{ _("Who has access:")}}</p>
                    <div  class="radio-list" ng-show="opportunity.owner.google_user_id=={{ME}}">
                        <label>
                            <input type="radio" name="optionRadio" value="public" ng-model="opportunity.access" ng-click="share();"/>
                            {{ _("public: Anyone within your organization can access and find")}}
                        </label>
                        <label >
                            <input type="radio" name="optionRadio"  value="private" ng-model="opportunity.access" ng-click="share();"/>
                            {{ _("private: only you and your collaborators")}}
                        </label>
                    </div>
                    <div ng-hide="opportunity.owner.google_user_id=={{ME}}">

                        <label>{{ _("you can't edit this  you are not the owner")}} </label> <br>
                        <label>{{ _("The owner is:")}}</label>
                          <div class="invitation">
                            <img class="google-avatar" ng-src="<%=opportunity.owner.google_public_profile_photo_url%>"/>
                            <%=opportunity.owner.display_name%> <  <a> <%=opportunity.owner.email%> </a> >
                        </div>
                    </div>
                    <hr/>
                    <div class='' id="collaborators">
                        <p>{{ _("Collaborators:")}}</p>
                        <div ng-repeat="collaborator in collaborators_list" class="invitation">
                            <img class="google-avatar" ng-src="<%=collaborator.img%>"/>
                            <%=collaborator.display_name%> <  <a> <%=collaborator.email%> </a> > 
                            <button class ="btn" ng-hide="opportunity.owner.google_user_id==collaborator.google_user_id || opportunity.access=='public' || opportunity.owner.google_user_id!={{ME}}" ng-click="DeleteCollaborator(collaborator.entityKey)">x</button>
                        </div>

                    </div>
                    <hr/>

                    <div ng-show="opportunity.owner.google_user_id=={{ME}}">
                        <p>{{ _("Invited user:")}}</p>
                        <div class="invitation" ng-repeat="invited in sharing_with">
                            <img class="google-avatar" ng-src="invited.google_public_profile_photo_url"/>
                            <strong> <%= invited.google_display_name %> < <%=invited.email%> ></strong>
                            <hr/>
                        </div>

                        <p>{{ _("Invite collaborators:")}}</p>
                        <div class="form-group">
                            <input type="text" ng-model="user" typeahead="user as user.google_display_name + ' <' + user.email + '>' for user in users | filter:$viewValue | limitTo:8" typeahead-on-select="selectMember()" class="form-control" placeholder="{{ _('Enter name or email addresse to add people to this group')}}">
                        </div>

                    </div>
            </div>
            <div class="modal-footer">
                <button class="btn" data-dismiss="modal" aria-hidden="true">{{_("Cancel")}}</button>
                <button  type="submit"  ng-click="share()" data-dismiss="modal" aria-hidden="true" class="btn blue addContactNow">{{_("Share")}}</button>
            </div>
            </form>
        </div>
    </div>

</div>
        <!--HKA 24.12.2013 Modal before Deleting Case-->
         <div id="BeforedeleteOpportunity" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
            <div class="modal-dialog">
              <div class="modal-content">
              <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                <h3 id="myModalLabel" class="modal-title">{{ _('Delete Opportunity')}}</h3>
              </div>
              <div class="modal-body">
                 <form id="seletesho" name="deletesho" class="form-horizontal">
                  <fieldset>

                  <p>{{_("Are you sure you want to delete")}} :  <%=opportunity.name %> .</p>



                    </fieldset>

              </div>
              <div class="modal-footer">
                <button class="btn" data-dismiss="modal" aria-hidden="true">{{_("Cancel")}}</button>
                <input  ng-click="deleteopportunity()" type="submit" class="btn red" value="Delete">
                <!--input ng-show="isLoading" type="submit" class="btn green" value="Loading..." disabled-->
              </div>
               </form>
          </div>
        </div>
       </div>
<div id="sendingEmail" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">

              <div class="modal-body">


                    <p ng-show="sending">{{ _('Sending...')}}</p>
                    <p ng-show="emailSent">{{ _('Your email has been sent')}}</p>




                    </fieldset>

              </div>
</div>
<div id="newDocument" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                <h3 id="myModalLabel" class="modal-title">
                  <img ng-src="/static/src/img/google_drive/<%=mimeType%>.png" class="" style="width: 27px;margin-top: -10px;">
                  {{ _("Create a new") }} <%=mimeType%>
                </h3>
            </div>
            <div class="modal-body">
                <div class="controls controls-row">
                    <form id="addTask" class="ng-pristine ng-valid">
                        <input class="form-control" autofocus type="text" placeholder="<%=mimeType | capitalizeFirst %> name ..."
                               id="taskTitle" ng-model="newdocument.title" required>


                </div>
            </div>
            <div class="modal-footer">
                <button class="btn" data-dismiss="modal" aria-hidden="true">{{ _('Cancel') }}</button>

                <input ng-hide="isLoading" type="submit" class="btn green" value="Create this document"
                       ng-click="createDocument(newdocument)">
                <input ng-show="isLoading" type="submit" class="btn green" value="Loading..." disabled>

                </form>
            </div>
        </div>
    </div>
</div>
  <div id="beforedeleteDoc" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"
     aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                <h3 id="myModalLabel" class="modal-title"><i class="fa fa-trash-o" style="font-size: 25px;"></i>  Delete Documents</h3>
            </div>
            <div class="modal-body">
                <form id="seletesho" name="deletesho" class="form-horizontal">
                    <fieldset>

                        <p style="font-size: 16px;text-align: center;" ng-show="selectedDocs.length > 1">{{ _("Are you sure you want to delete") }} : <span style="color:blue"> <%=selectedDocs.length %> </span>  {{ _("documents") }} ?</p>
                        <p style="font-size: 16px;text-align: center;" ng-show="selectedDocs.length == 1">{{ _("Are you sure you want to delete") }} : <span style="color:blue"> <%=selectedDocs[0].title %> </span> ?</p>


                    </fieldset>
                </form>

            </div>
            <div class="modal-footer">
                <button class="btn" data-dismiss="modal" aria-hidden="true">{{ _("Cancel") }}</button>

                <input ng-click="deleteDocs()" type="submit" class="btn red" value="Delete">
                <!--input ng-show="isLoading" type="submit" class="btn green" value="Loading..." disabled-->
            </div>

        </div>
    </div>
</div>
 <div id="EditCloseDate" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
              <div class="modal-dialog">
              <div class="modal-content">
              <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                <h3 id="myModalLabel" class="modal-title">{{_("Edit Case")}}</h3>
              </div>

              <div class="modal-body">
                 <form id="editTagline" name="editlead" ng-submit="updateClosedate(casee)" class="form-horizontal">


                  <div class="form-group">


                        <div class="col-md-12">

                           <p><strong>{{_("Close Date")}}</strong></p>
                                                  <center>
                                                    <datetimepicker data-ng-model="casee.closed_date"
                                                    data-datetimepicker-config="{ startView:'day', minView:'day' }" />
                                                  </center>

                        </div>
                    </div>
              </div>
              <div class="modal-footer">
                <button class="btn" data-dismiss="modal" aria-hidden="true">{{_("Close")}}</button>
                <button  type="submit" class="btn btn-primary addContactNow">{{_("Save")}} </button>
              </div>
               </form>
               </div>
               </div>
            </div>

        <!--HKA 06.03.2014 Main Competitor Modal -->
            <div id="EditCompetitor" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
              <div class="modal-dialog">
              <div class="modal-content">
              <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                <h3 id="myModalLabel" class="modal-title">{{_("Edit Opportunity")}}</h3>
              </div>

              <div class="modal-body">
                 <form id="editTagline" name="editlead" ng-submit="updateCompetitor(opportunity)" class="form-horizontal">


                  <div class="form-group">
                        <label  class="col-md-3 control-label">{{_("Competitors")}} </label>

                        <div class="col-md-9">

                           <textarea id="noteBody" class="form-control ng-pristine ng-valid" rows="3" ng-model="opportunity.competitor"></textarea>

                        </div>
                    </div>
              </div>
              <div class="modal-footer">
                <button class="btn" data-dismiss="modal" aria-hidden="true">{{_("Close")}}</button>
                <button  type="submit" class="btn btn-primary addContactNow">{{_("Save")}} </button>
              </div>
               </form>
               </div>
               </div>
            </div>

           <!-- HKA 06.03.2014 Reason lost Modal -->

           <div id="EditReasonLost" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
              <div class="modal-dialog">
              <div class="modal-content">
              <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                <h3 id="myModalLabel" class="modal-title">{{_("Edit Opportunity")}}</h3>
              </div>

              <div class="modal-body">
                 <form id="editTagline" name="editlead" ng-submit="updateReasonlost(opportunity)" class="form-horizontal">


                  <div class="form-group">
                        <label  class="col-md-3 control-label">{{_("Reason Lost")}} </label>

                        <div class="col-md-9">

                        <textarea id="noteBody" class="form-control ng-pristine ng-valid" rows="3" ng-model="opportunity.reason_lost"></textarea>

                        </div>
                    </div>
              </div>
              <div class="modal-footer">
                <button class="btn" data-dismiss="modal" aria-hidden="true">{{_("Close")}}</button>
                <button  type="submit" class="btn btn-primary addContactNow">{{_("Save")}} </button>
              </div>
               </form>
               </div>
               </div>
            </div>

             <!-- HKA 06.03.2014 edit Description Modal -->

           <div id="EditDescription" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
              <div class="modal-dialog">
              <div class="modal-content">
              <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                <h3 id="myModalLabel" class="modal-title">{{_("Edit Case")}}</h3>
              </div>

              <div class="modal-body">
                 <form id="editTagline" name="editlead" ng-submit="updateDescription(casee)" class="form-horizontal">


                  <div class="form-group">
                        <label  class="col-md-3 control-label">{{_("Description")}} </label>

                        <div class="col-md-9">

                           <textarea id="noteBody" class="form-control ng-pristine ng-valid" rows="3" ng-model="casee.description"></textarea>

                        </div>
                    </div>
              </div>
              <div class="modal-footer">
                <button class="btn" data-dismiss="modal" aria-hidden="true">{{_("Close")}}</button>
                <button  type="submit" class="btn btn-primary addContactNow">{{_("Save")}} </button>
              </div>
               </form>
               </div>
               </div>
            </div>

            <!--HKA 06.03.2014 Type Modal -->
            <div id="EditType" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
              <div class="modal-dialog">
              <div class="modal-content">
              <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                <h3 id="myModalLabel" class="modal-title">{{_("Edit Case")}}</h3>
              </div>

              <div class="modal-body">
                 <form id="editTagline" name="editlead" ng-submit="updateType(casee)" class="form-horizontal">


                  <div class="form-group">
                        <label  class="col-md-3 control-label">{{_("Type")}} </label>

                        <div class="col-md-9">
                          <select ng-model="casee.type_case" class="form-control"><option value="">--{{ _('None')}}--</option><option value="Mechanical">{{ _('Mechanical')}}</option><option value="Electrical">{{ _('Electrical')}}</option><option value="Electronic">{{ _('Electronic')}}</option><option value="New Customer">{{ _('New Customer')}}</option><option value="Other">{{ _('Other')}}</option></select>


                        </div>
                    </div>
              </div>
              <div class="modal-footer">
                <button class="btn" data-dismiss="modal" aria-hidden="true">{{_("Close")}}</button>
                <button  type="submit" class="btn btn-primary addContactNow">{{_("Save")}} </button>
              </div>
               </form>
               </div>
               </div>
            </div>

            <!--HKA 06.03.2014 source Modal -->
            <div id="EditOrigin" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
              <div class="modal-dialog">
              <div class="modal-content">
              <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                <h3 id="myModalLabel" class="modal-title">{{_("Edit Case")}}</h3>
              </div>

              <div class="modal-body">
                 <form id="editTagline" name="editlead" ng-submit="updatcaseorigin(casee)" class="form-horizontal">


                  <div class="form-group">
                        <label  class="col-md-3 control-label">{{_("Case Origin")}} </label>

                        <div class="col-md-9">
                          <select ng-model="casee.case_origin" class="form-control"><option value="">--{{ _('None')}}--</option><option value="Email">{{ _('Email')}}</option><option value="Social Media">{{ _('Social Media')}}</option><option value="Web Source">{{ _('Web Site')}}</option><option value="Phone">{{ _('Phone Inquiry')}}</option><option value="Other">{{ _('Other')}}</option></select>


                        </div>
                    </div>
              </div>
              <div class="modal-footer">
                <button class="btn" data-dismiss="modal" aria-hidden="true">{{_("Close")}}</button>
                <button  type="submit" class="btn btn-primary addContactNow">{{_("Save")}} </button>
              </div>
               </form>
               </div>
               </div>
            </div>

            <!--HKA 06.03.2014 Custom fields Modal -->

            <div id="customfields" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
            <div class="modal-dialog">
              <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                <h3 id="myModalLabel" class="modal-title">{{_("Add Custom Field")}}</h3>
            </div>
            <div class="modal-body">
                  <form id="addWebsite" name="addwebsite"  class="form-horizontal">
                    <div class="form-group">
                        <label  class="col-md-3 control-label">{{_("Custom Field")}} </label>
                        <div class="col-md-9">
                          <div class="form-group">
                               <input type="text" class="form-control" placeholder="{{ _('Field')}}"  ng-model="customField.field">
                          </div>
                          <div class="form-group">
                               <input type="text" class="form-control" placeholder="{{ _('Value')}}"  ng-model="customField.value">
                          </div>
                        </div>
                     </div>
              </div>
              <div class="modal-footer">
                  <button class="btn" data-dismiss="modal" aria-hidden="true">{{_("Cancel")}}</button>

                  <input   ng-click="addCustomField(customField)" ng-disabled="!(customField.field && customField.value)" type="submit" class="btn green" value="{{_('Add this custom field')}}">
                  <!--input ng-show="isLoading" type="submit" class="btn green" value="{{_('Loading...')}}" disabled-->
              </div>
                </form>
                </div>
                </div>
        </div>
 <!--HKA 11.10.2013 Edit Opportunity -->
             <div id="EditOpportunityModal" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
             <div class="modal-dialog">
              <div class="modal-content">
              <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                <h3 id="myModalLabel" class="modal-title">{{_("Edit Opportunity")}}</h3>
              </div>

              <div class="modal-body">
                 <form id="editAccount" name="editlead"  class="form-horizontal">

                  <div class="form-group">
                                <label  class=" col-md-3 control-label">{{_("Owner")}} </label>
                                <div class="col-md-9">
                                    <select class="form-control" ng-model="ownerSelected" ng-options="user.google_display_name for user in users" >
                                        <option value=""><%=opportunity.owner.google_display_name%> </option>
                                        <!--option value=""><%=stage_selected.name%></option-->
                                    </select>
                                </div>
                  </div>
                  <div class="form-group">
                        <label  class="required col-md-3 control-label">{{_("Name")}} </label>

                        <div class="col-md-9">
                          <input type="text"  class="form-control" required id="id_name" ng-model="opportunity.name">

                        </div>
                    </div>
                  <!--div class="form-group">
                        <label  class="required col-md-3 control-label">{{_( "Amount")}} </label>

                        <div class="col-md-9">
                          <input type="text" class="form-control"  id="id_amount" ng-model="opportunity.amount">

                        </div>
                    </div>
                    <div class="form-group">
                        <label  class="required col-md-3 control-label">{{_("Stage")}} </label>

                        <div class="col-md-9">
                          <select ng-model="stage_selected" ng-options="opps.name + ' - ( ' + opps.probability + '% )' for opps in opportunitystages | orderBy: 'name':true" class="form-control" >
                            <option value=""><%=opportunity.stagename%> </option>


                          </select>

                        </div>
                    </div-->

              </div>
              <div class="modal-footer">
                <button class="btn" data-dismiss="modal" aria-hidden="true">{{_("Close")}}</button>
                <button  type="submit" ng-click="UpdateOpportunity(opportunity)" class="btn btn-primary addContactNow">{{_("Save")}} </button>
              </div>
               </form>
              </div>
              </div>
            </div>
        </div>
<div id="newEventModal" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
<div class="modal-dialog">
  <div class="modal-content">
  <div class="modal-header">
    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
    <h3 id="myModalLabel" class="modal-title">{{_("New Event")}}</h3>
  </div>
  <div class="modal-body">
           <div class="controls controls-row">
                  <form id="addTask"  class="ng-pristine ng-valid">
                                        <input class="form-control" autofocus type="text" placeholder="{{_('Add a new event')}}" id="taskTitle" ng-model="ioevent.title">
                                        <p><strong>{{_("When?")}}</strong></p>
                                      <div class="row">
                                        <div class="col-md-6">
                                          <p> <strong>{{_("Starts")}}</strong>: <%=ioevent.starts_at | date:'MMMM dd, yyyy, HH:mm'%></p>
                                              <datetimepicker data-ng-model="ioevent.starts_at"
                                          data-datetimepicker-config="{ startView:'day', minView:'minute' }" />
                                        </div>
                                        <div class="col-md-6">
                                        <p><strong>{{_("Ends")}}</strong>: <%=ioevent.ends_at | date:'MMMM dd, yyyy, HH:mm'%></p>
                                              <datetimepicker data-ng-model="ioevent.ends_at"
                                          data-datetimepicker-config="{ startView:'day', minView:'minute' }" />
                                        </div>
                                      </div>
                                          <input class="form-control" autofocus="" type="text" placeholder="{{_('Where?')}}" id="taskTitle" ng-model="ioevent.where">
                                      </div>
                                      </form>
  </div>
  <div class="modal-footer">
    <button class="btn" data-dismiss="modal" aria-hidden="true">{{_("Cancel")}}</button>

     <input ng-hide="isLoading" type="submit" class="btn green" value="{{_('Add this event')}}" ng-click="addEvent(ioevent)">
      <input ng-show="isLoading" type="submit" class="btn green" value="{{_('Loading...')}}" disabled>


  </div>
  </div>
  </div>
</div>

              <!-- Modal -->
<div id="myModal" class="modal fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
<div class="modal-dialog">
    <div class="modal-content">
  <div class="modal-header">
    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
    <h3 id="myModalLabel" class="modal-title">{{_("Add a new Task")}}</h3>
  </div>
  <div class="modal-body pickerin">
           <div class="controls controls-row">
                                <form id="addTask"  class="ng-pristine ng-valid">
                                        <input class="form-control" autofocus type="text" placeholder="{{_('Add a new task')}}" id="taskTitle" ng-model="task.title">

                                        <p><strong>{{_("When's it due?")}}</strong></p>
                                        <center>
                                          <datetimepicker data-ng-model="task.due"
                                          data-datetimepicker-config="{ startView:'day', minView:'day' }" />
                                        </center>
        </div>
  </div>
  <div class="modal-footer">
    <button class="btn" data-dismiss="modal" aria-hidden="true">{{_("Cancel")}}</button>

     <input ng-hide="isLoading" type="submit" ng-click="addTask(task)" class="btn green" value="Add this task">
      <input ng-show="isLoading" type="submit" class="btn green" value="Loading..." disabled>

  </form>
  </div>
  </div>
  </div>
</div>


<!--Event Modal -->
          <div id="newEventModalForm" class="modal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
          <div class="modal-dialog">
            <div class="modal-content">
          
            <div class="modal-body">
                     <div class="controls controls-row">
                            <form id="addTask"  class="ng-pristine ng-valid">

                            <div class="inner-addon left-addon" >
                                 <i class="glyphicon glyphicon-pencil" style="color: rgba(0, 26, 131, 0.61);   margin-top: -10px;"></i>
                                     <input class="form-control calendar-form-controle" autofocus type="text" placeholder="{{_('Event title')}}" id="taskTitle" ng-model="ioevent.title" style="padding-bottom: 20px;">
                                 
                              
                                     
                             </div>

                              <div class="" >
                                  <i class="glyphicon glyphicon-calendar" style="color: rgba(0, 26, 131, 0.61); margin-left:10px;  margin-top: -5px;"></i>
                                    <div class="row" style="margin-left:80px">
                                    <div class="col-md-2" style="border-right: 1px solid #C5C2C2;margin-right: 36px;height: 53px;">
                                    <div style="margin-top:15px">
                                      all day <div class="customCheckbox " class="form-group" style="
    margin-top: -14px;
    margin-left: 41px;
">  
                            <input title="Select allday" type="checkbox" ng-model="allday" ng-click="checkallday()" id="allday">             
                              <label for="allday" class="labelElement">
                                <span class="check" style="  height: 17px !important;width: 8px !important;   margin-top: -4px;"></span>
                                <span class="box" style="  height: 15px !important;width: 15px !important;   margin-top: -13px;"></span>
                              </label>  
                          </div>
                                    </div>
                                         
                                    </div>
                                    <div class="col-md-8">
                                          <div class="row" ng-show="allday" style="margin-top: 20px;">
                                            
                                                     <div class="oppEstDate" style="display: inline-block; float: left; padding-left: 15px; max-width: 75%;">
                                                      <span ng-hide="showStartsCalendar" ng-click="showStartsCalendar=true"><i class="fa fa-calendar"></i>
                                                       <%=ioevent.starts_at_allday| date:'dd MMMM yyyy'%></span>
                                                      <div ng-show="showStartsCalendar" class="input-icon">
                                                           <i class="fa fa-calendar"></i>
                                                           <input lang="de" cdatetimepicker data-model="ioevent.starts_at_allday" type="text" class="form-control calendar-form-controle" placeholder="{{ _('mm/dd/yyyy hh:mm am')}}" value="" id="">
                                                      </div>
                                                    </div>
                                                                
                                                    
                                          </div>
                                         <div class="row"  ng-hide="allday">
                                                   <div> <strong style="float: left;">{{_("Starts")}}</strong><span style="float: left;">:</span>
                                                     <div class="oppEstDate" style="display: inline-block; float: left; padding-left: 15px; max-width: 75%;">
                                                    <!--  <input id="datetimepickerjquery" type="text" > -->
                                           

                                    <span ng-hide="showStartsCalendar||showEventInput" ng-click="showStartsCalendar=true"><i class="fa fa-calendar"></i>
                                                   <%=ioevent.starts_at| date:'dd MMMM yyyy, HH:mm'%></span>
                                   <div ng-show="showStartsCalendar||showEventInput" class="input-icon">
                                              <i class="fa fa-calendar"></i>
                                    <input  cdatetimepicker data-model="ioevent.starts_at" type="text" class="form-control calendar-form-controle" placeholder="{{ _('mm/dd/yyyy hh:mm am')}}" value="" id="leadEventStartsAt">
                                          <!--  <input cusdatetimepicker data-model="start_event_draw" type="text" class="form-control calendar-form-controle" placeholder="{{ _('Click to change the estimated date')}}" value="" id=""> -->
                                           </div>
                                                    </div>
                                                                
                                                    </div>
                                       </div>
                                       <div class="row" style="margin-top:10px;" ng-hide="allday">
                                              <div> <strong style="float: left;">{{_("Ends  ")}}</strong><span style="float: left;">  :</span>
                                          <div class="oppEstDate" style="display: inline-block; float: left; padding-left: 15px; max-width: 75%; margin-left:8px">
                                              <span ng-hide="showEndsCalendar||showEventInput" ng-click="showEndsCalendar=true"><i class="fa fa-calendar"></i>
                                                       <%=ioevent.ends_at| date:'dd MMMM yyyy, HH:mm'%></span>
                                            <div ng-show="showEndsCalendar||showEventInput" class="input-icon">
                                                           <i class="fa fa-calendar"></i>
                                        <input  cdatetimepicker data-model="ioevent.ends_at" type="text" class="form-control calendar-form-controle" placeholder="{{ _('mm/dd/yyyy hh:mm am')}}" value="" id="leadEventEndsAt">

                                                <!--   <input cusdatetimepicker data-model="" type="text" class="form-control calendar-form-controle" placeholder="{{ _('Click to change the estimated date')}}" value="" id="leadEventStartsAt"> -->
                                            </div>
                                                    </div>
                                       </div>  
                                    </div>
                                    <div class="row" style="margin-top:15px">
                                    <a ng-click="timezonepicker=true" href="" ng-hide="timezonepicker">Timezone</a>
  <select id="timeZone" ng-show="timezonepicker" style="width: 100px;">
  <option timeZoneId="1" gmtAdjustment="GMT-12:00" useDaylightTime="0" value="-12:00">(GMT-12:00) International Date Line West</option>
  <option timeZoneId="2" gmtAdjustment="GMT-11:00" useDaylightTime="0" value="-11:00">(GMT-11:00) Midway Island, Samoa</option>
  <option timeZoneId="3" gmtAdjustment="GMT-10:00" useDaylightTime="0" value="-10:00">(GMT-10:00) Hawaii</option>
  <option timeZoneId="4" gmtAdjustment="GMT-09:00" useDaylightTime="1" value="-09:00">(GMT-09:00) Alaska</option>
  <option timeZoneId="5" gmtAdjustment="GMT-08:00" useDaylightTime="1" value="-08:00">(GMT-08:00) Pacific Time (US & Canada)</option>
  <option timeZoneId="6" gmtAdjustment="GMT-08:00" useDaylightTime="1" value="-08:00">(GMT-08:00) Tijuana, Baja California</option>
  <option timeZoneId="7" gmtAdjustment="GMT-07:00" useDaylightTime="0" value="-07:00">(GMT-07:00) Arizona</option>
  <option timeZoneId="8" gmtAdjustment="GMT-07:00" useDaylightTime="1" value="-07:00">(GMT-07:00) Chihuahua, La Paz, Mazatlan</option>
  <option timeZoneId="9" gmtAdjustment="GMT-07:00" useDaylightTime="1" value="-07:00">(GMT-07:00) Mountain Time (US & Canada)</option>
  <option timeZoneId="10" gmtAdjustment="GMT-06:00" useDaylightTime="0" value="-06:00">(GMT-06:00) Central America</option>
  <option timeZoneId="11" gmtAdjustment="GMT-06:00" useDaylightTime="1" value="-06:00">(GMT-06:00) Central Time (US & Canada)</option>
  <option timeZoneId="12" gmtAdjustment="GMT-06:00" useDaylightTime="1" value="-06:00">(GMT-06:00) Guadalajara, Mexico City, Monterrey</option>
  <option timeZoneId="13" gmtAdjustment="GMT-06:00" useDaylightTime="0" value="-06:00">(GMT-06:00) Saskatchewan</option>
  <option timeZoneId="14" gmtAdjustment="GMT-05:00" useDaylightTime="0" value="-05:00">(GMT-05:00) Bogota, Lima, Quito, Rio Branco</option>
  <option timeZoneId="15" gmtAdjustment="GMT-05:00" useDaylightTime="1" value="-05:00">(GMT-05:00) Eastern Time (US & Canada)</option>
  <option timeZoneId="16" gmtAdjustment="GMT-05:00" useDaylightTime="1" value="-05:00">(GMT-05:00) Indiana (East)</option>
  <option timeZoneId="17" gmtAdjustment="GMT-04:00" useDaylightTime="1" value="-04:00">(GMT-04:00) Atlantic Time (Canada)</option>
  <option timeZoneId="18" gmtAdjustment="GMT-04:00" useDaylightTime="0" value="-04:00">(GMT-04:00) Caracas, La Paz</option>
  <option timeZoneId="19" gmtAdjustment="GMT-04:00" useDaylightTime="0" value="-04:00">(GMT-04:00) Manaus</option>
  <option timeZoneId="20" gmtAdjustment="GMT-04:00" useDaylightTime="1" value="-04:00">(GMT-04:00) Santiago</option>
  <option timeZoneId="21" gmtAdjustment="GMT-03:30" useDaylightTime="1" value="-03.30">(GMT-03:30) Newfoundland</option>
  <option timeZoneId="22" gmtAdjustment="GMT-03:00" useDaylightTime="1" value="-03:00">(GMT-03:00) Brasilia</option>
  <option timeZoneId="23" gmtAdjustment="GMT-03:00" useDaylightTime="0" value="-03:00">(GMT-03:00) Buenos Aires, Georgetown</option>
  <option timeZoneId="24" gmtAdjustment="GMT-03:00" useDaylightTime="1" value="-03:00">(GMT-03:00) Greenland</option>
  <option timeZoneId="25" gmtAdjustment="GMT-03:00" useDaylightTime="1" value="-03:00">(GMT-03:00) Montevideo</option>
  <option timeZoneId="26" gmtAdjustment="GMT-02:00" useDaylightTime="1" value="-02:00">(GMT-02:00) Mid-Atlantic</option>
  <option timeZoneId="27" gmtAdjustment="GMT-01:00" useDaylightTime="0" value="-01:00">(GMT-01:00) Cape Verde Is.</option>
  <option timeZoneId="28" gmtAdjustment="GMT-01:00" useDaylightTime="1" value="-01:00">(GMT-01:00) Azores</option>
  <option timeZoneId="29" gmtAdjustment="GMT+00:00" useDaylightTime="0" value="+00:00">(GMT+00:00) Casablanca, Monrovia, Reykjavik</option>
  <option timeZoneId="30" gmtAdjustment="GMT+00:00" useDaylightTime="1" value="+00:00">(GMT+00:00) Greenwich Mean Time : Dublin, Edinburgh, Lisbon, London</option>
  <option timeZoneId="31" gmtAdjustment="GMT+01:00" useDaylightTime="1" value="+01:00">(GMT+01:00) Amsterdam, Berlin, Bern, Rome, Stockholm, Vienna</option>
  <option timeZoneId="32" gmtAdjustment="GMT+01:00" useDaylightTime="1" value="+01:00">(GMT+01:00) Belgrade, Bratislava, Budapest, Ljubljana, Prague</option>
  <option timeZoneId="33" gmtAdjustment="GMT+01:00" useDaylightTime="1" value="+01:00">(GMT+01:00) Brussels, Copenhagen, Madrid, Paris</option>
  <option timeZoneId="34" gmtAdjustment="GMT+01:00" useDaylightTime="1" value="+01:00">(GMT+01:00) Sarajevo, Skopje, Warsaw, Zagreb</option>
  <option timeZoneId="35" gmtAdjustment="GMT+01:00" useDaylightTime="1" value="+01:00">(GMT+01:00) West Central Africa</option>
  <option timeZoneId="36" gmtAdjustment="GMT+02:00" useDaylightTime="1" value="+02:00">(GMT+02:00) Amman</option>
  <option timeZoneId="37" gmtAdjustment="GMT+02:00" useDaylightTime="1" value="+02:00">(GMT+02:00) Athens, Bucharest, Istanbul</option>
  <option timeZoneId="38" gmtAdjustment="GMT+02:00" useDaylightTime="1" value="+02:00">(GMT+02:00) Beirut</option>
  <option timeZoneId="39" gmtAdjustment="GMT+02:00" useDaylightTime="1" value="+02:00">(GMT+02:00) Cairo</option>
  <option timeZoneId="40" gmtAdjustment="GMT+02:00" useDaylightTime="0" value="+02:00">(GMT+02:00) Harare, Pretoria</option>
  <option timeZoneId="41" gmtAdjustment="GMT+02:00" useDaylightTime="1" value="+02:00">(GMT+02:00) Helsinki, Kyiv, Riga, Sofia, Tallinn, Vilnius</option>
  <option timeZoneId="42" gmtAdjustment="GMT+02:00" useDaylightTime="1" value="+02:00">(GMT+02:00) Jerusalem</option>
  <option timeZoneId="43" gmtAdjustment="GMT+02:00" useDaylightTime="1" value="+02:00">(GMT+02:00) Minsk</option>
  <option timeZoneId="44" gmtAdjustment="GMT+02:00" useDaylightTime="1" value="+02:00">(GMT+02:00) Windhoek</option>
  <option timeZoneId="45" gmtAdjustment="GMT+03:00" useDaylightTime="0" value="+03:00">(GMT+03:00) Kuwait, Riyadh, Baghdad</option>
  <option timeZoneId="46" gmtAdjustment="GMT+03:00" useDaylightTime="1" value="+03:00">(GMT+03:00) Moscow, St. Petersburg, Volgograd</option>
  <option timeZoneId="47" gmtAdjustment="GMT+03:00" useDaylightTime="0" value="+03:00">(GMT+03:00) Nairobi</option>
  <option timeZoneId="48" gmtAdjustment="GMT+03:00" useDaylightTime="0" value="+03:00">(GMT+03:00) Tbilisi</option>
  <option timeZoneId="49" gmtAdjustment="GMT+03:30" useDaylightTime="1" value="+03:30">(GMT+03:30) Tehran</option>
  <option timeZoneId="50" gmtAdjustment="GMT+04:00" useDaylightTime="0" value="+04:00">(GMT+04:00) Abu Dhabi, Muscat</option>
  <option timeZoneId="51" gmtAdjustment="GMT+04:00" useDaylightTime="1" value="+04:00">(GMT+04:00) Baku</option>
  <option timeZoneId="52" gmtAdjustment="GMT+04:00" useDaylightTime="1" value="+04:00">(GMT+04:00) Yerevan</option>
  <option timeZoneId="53" gmtAdjustment="GMT+04:30" useDaylightTime="0" value="+04:30">(GMT+04:30) Kabul</option>
  <option timeZoneId="54" gmtAdjustment="GMT+05:00" useDaylightTime="1" value="+05:00">(GMT+05:00) Yekaterinburg</option>
  <option timeZoneId="55" gmtAdjustment="GMT+05:00" useDaylightTime="0" value="+05:00">(GMT+05:00) Islamabad, Karachi, Tashkent</option>
  <option timeZoneId="56" gmtAdjustment="GMT+05:30" useDaylightTime="0" value="+05:30">(GMT+05:30) Sri Jayawardenapura</option>
  <option timeZoneId="57" gmtAdjustment="GMT+05:30" useDaylightTime="0" value="+05:30">(GMT+05:30) Chennai, Kolkata, Mumbai, New Delhi</option>
  <option timeZoneId="58" gmtAdjustment="GMT+05:45" useDaylightTime="0" value="+05:45">(GMT+05:45) Kathmandu</option>
  <option timeZoneId="59" gmtAdjustment="GMT+06:00" useDaylightTime="1" value="+06:00">(GMT+06:00) Almaty, Novosibirsk</option>
  <option timeZoneId="60" gmtAdjustment="GMT+06:00" useDaylightTime="0" value="+06:00">(GMT+06:00) Astana, Dhaka</option>
  <option timeZoneId="61" gmtAdjustment="GMT+06:30" useDaylightTime="0" value="+06:30">(GMT+06:30) Yangon (Rangoon)</option>
  <option timeZoneId="62" gmtAdjustment="GMT+07:00" useDaylightTime="0" value="+07:00">(GMT+07:00) Bangkok, Hanoi, Jakarta</option>
  <option timeZoneId="63" gmtAdjustment="GMT+07:00" useDaylightTime="1" value="+07:00">(GMT+07:00) Krasnoyarsk</option>
  <option timeZoneId="64" gmtAdjustment="GMT+08:00" useDaylightTime="0" value="+08:00">(GMT+08:00) Beijing, Chongqing, Hong Kong, Urumqi</option>
  <option timeZoneId="65" gmtAdjustment="GMT+08:00" useDaylightTime="0" value="+08:00">(GMT+08:00) Kuala Lumpur, Singapore</option>
  <option timeZoneId="66" gmtAdjustment="GMT+08:00" useDaylightTime="0" value="+08:00">(GMT+08:00) Irkutsk, Ulaan Bataar</option>
  <option timeZoneId="67" gmtAdjustment="GMT+08:00" useDaylightTime="0" value="+08:00">(GMT+08:00) Perth</option>
  <option timeZoneId="68" gmtAdjustment="GMT+08:00" useDaylightTime="0" value="+08:00">(GMT+08:00) Taipei</option>
  <option timeZoneId="69" gmtAdjustment="GMT+09:00" useDaylightTime="0" value="+09:00">(GMT+09:00) Osaka, Sapporo, Tokyo</option>
  <option timeZoneId="70" gmtAdjustment="GMT+09:00" useDaylightTime="0" value="+09:00">(GMT+09:00) Seoul</option>
  <option timeZoneId="71" gmtAdjustment="GMT+09:00" useDaylightTime="1" value="+09:00">(GMT+09:00) Yakutsk</option>
  <option timeZoneId="72" gmtAdjustment="GMT+09:30" useDaylightTime="0" value="+09:30">(GMT+09:30) Adelaide</option>
  <option timeZoneId="73" gmtAdjustment="GMT+09:30" useDaylightTime="0" value="+09:30">(GMT+09:30) Darwin</option>
  <option timeZoneId="74" gmtAdjustment="GMT+10:00" useDaylightTime="0" value="+10:00">(GMT+10:00) Brisbane</option>
  <option timeZoneId="75" gmtAdjustment="GMT+10:00" useDaylightTime="1" value="+10:00">(GMT+10:00) Canberra, Melbourne, Sydney</option>
  <option timeZoneId="76" gmtAdjustment="GMT+10:00" useDaylightTime="1" value="+10:00">(GMT+10:00) Hobart</option>
  <option timeZoneId="77" gmtAdjustment="GMT+10:00" useDaylightTime="0" value="+10:00">(GMT+10:00) Guam, Port Moresby</option>
  <option timeZoneId="78" gmtAdjustment="GMT+10:00" useDaylightTime="1" value="+10:00">(GMT+10:00) Vladivostok</option>
  <option timeZoneId="79" gmtAdjustment="GMT+11:00" useDaylightTime="1" value="+11:00">(GMT+11:00) Magadan, Solomon Is., New Caledonia</option>
  <option timeZoneId="80" gmtAdjustment="GMT+12:00" useDaylightTime="1" value="+12:00">(GMT+12:00) Auckland, Wellington</option>
  <option timeZoneId="81" gmtAdjustment="GMT+12:00" useDaylightTime="0" value="+12:00">(GMT+12:00) Fiji, Kamchatka, Marshall Is.</option>
  <option timeZoneId="82" gmtAdjustment="GMT+13:00" useDaylightTime="0" value="+13:00">(GMT+13:00) Nuku'alofa</option>
</select>  
                                    </div>
                                    </div>
                                    
                                      
                             </div>
        <div class=" inner-addon left-addon" style="margin-top:30px">
         <i class="glyphicon glyphicon-map-marker" style="color: rgba(0, 26, 131, 0.61); margin-top: -5px;"></i>
          <input class="form-control calendar-form-controle" autofocus="" type="text" placeholder="{{_('Where?')}}" id="pac-input2" ng-model="ioevent.where" style="margin-top:15px">
          <a ng-show="locationShosen" href="" ng-click="lunchMapsCalendar()" style="margin-left: 31px;" >
                                                   see on map</a>
                  </div>

                            <div class=" inner-addon left-addon">
                                        <i class="fa fa-group" style="color: rgba(0, 26, 131, 0.61);
  margin-top: 7px !important;
  position: absolute;
  margin-left: 9px;"></i>
       <input class="form-control calendar-form-controle" autofocus="" type="text" placeholder="{{_('add emails of guests')}}" id="taskTitle" ng-model="invite" style="margin-top:15px"  ng-keyup="$event.keyCode == 13&& addInvite(invite)"  typeahead="inviteResult as inviteResult.emails for inviteResult in inviteResults | filter:$viewValue | limitTo:8" typeahead-on-select="selectInviteResult()">
                                                       
                         </div>
                                                   <ul  style="list-style:none">
                                                       <li ng-repeat="inv in invites" style="margin-top: 5px;">
                                                       <span  style="  border: 1px solid rgba(10, 18, 168, 0.258824);
  padding: 3px;
  color: rgb(108, 108, 108);
  border-radius: 3px !important;
  background-color: rgba(154, 157, 205, 0.258824);"><i class="fa fa-user" style="color: rgba(0, 26, 131, 0.61);  margin-top: -5px;"></i> <%=inv%> <a href="" ng-click="deleteInvite($index)" class=" calendar-close-invite"  style=" top: 2px !important;"></a>
  </span></li>
                                                   </ul>
                                               <ul style="list-style:none" ng-show="Guest_params">
                                                 <li> <strong> Guests can:</strong> </li>
                                                 <li><input type="checkbox" ng-checked="false"  ng-model="guest_modify" > modify event</li> 
                                                 <li><input type="checkbox" ng-checked="true" ng-model="guest_invite" ng-disabled="guest_modify">invite others</li>
                                                 <li><input type="checkbox" ng-disabled="guest_modify" ng-checked="true" ng-model="guest_list">see guest list</li>
                                               </ul>

                         
                         
<div class="row"  style="margin-top: 16px;">
                             <i class="glyphicon glyphicon-bell" style="color: rgba(0, 26, 131, 0.61); margin-left:24px;  margin-top: -5px;"></i>
                               <div style=" margin-left:46px;margin-top:-16px ">
                               <div class="dropdown">
  <button class="btn btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" aria-expanded="true" style="  border: none !important;
  color: rgba(0, 0, 0, 0.44);">
    Remind me  
    <span class="caret"></span>
  </button> <span ng-show="something_picked" style="  border: 1px solid rgba(10, 18, 168, 0.258824);
  padding: 3px;
  color: rgb(108, 108, 108);
  border-radius: 3px !important;
  background-color: rgba(154, 157, 205, 0.258824);"> <%=remindme_show %><a href="" ng-click="deletePicked()" class=" calendar-close-invite"  style=" top: 2px !important;"></a></span> 
<!--      <ul  class="list-inline"style="list-style:none" ng-show="remindmeby">
                                                 <li> <strong> By:</strong> </li>
                                                 <li><input type="radio"  name="by" ng-model="method" value="email"> Email</li> 
                                                 <li><input type="radio" ng- name="by" ng-model="method" value="sms">SMS</li>
                                                
                                               </ul> -->
  <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenu1">
    <li role="presentation"><a role="menuitem" tabindex="-1" ng-click="Remindme(0)">No notification</a></li>
    <li role="presentation"><a role="menuitem" tabindex="-1" ng-click="Remindme(1)"> At time of event</a></li>
    <li role="presentation"><a role="menuitem" tabindex="-1" ng-click="Remindme(2)">30 minutes before</a></li>
    <li role="presentation"><a role="menuitem" tabindex="-1" ng-click="Remindme(3)">1 hour </a></li>
    <li role="presentation"><a role="menuitem" tabindex="-1" ng-click="Remindme(4)">1 day </a></li>
    <li role="presentation"><a role="menuitem" tabindex="-1" ng-click="Remindme(5)">1 week </a></li>

  </ul>
</div>
                      
                        

                               </div>                            
                            </div>

       <div class=" inner-addon left-addon" style="margin-top:10px">
                                                       <i class="glyphicon glyphicon-align-left" style="color: rgba(0, 26, 131, 0.61);  margin-top: -5px;"></i>
                                                    <input class="form-control calendar-form-controle" autofocus="" type="text" placeholder="{{_('Add note')}}" id="note" ng-model="ioevent.note" style="margin-top:15px">
              </div>
                           
                            

                        </div>
               
                                                </form>
            </div>
            <div class="modal-footer " style="border-top:none!important;">
              <button class="btn" data-dismiss="modal" aria-hidden="true" ng-click="cancelAddOperation()">{{_("Cancel")}}</button>

               <input ng-hide="isLoading" type="submit" class="btn red" value="{{_('Add event')}}" ng-click="addEvent(ioevent)">
                <input ng-show="isLoading" type="submit" class="btn green" value="{{_('Loading...')}}" disabled>


            </div>
            </div>
            </div>
          </div>
          </div>
<!-- end of event form -->
<div id="assigneeTagsToOpp" class="modal fade customPopUp" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"
     aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                <h3 id="myModalLabel" class="modal-title"> +<i class="fa fa-tags"></i> {{ _('Add Tags') }} </h3>
            </div>
            <div class="modal-body">
                <form id="seletesho" name="deletesho" class="form-horizontal">
                    <div class="form-group">
                        <select id="select2_sample2" class="form-control select2" multiple>
                            <option ng-repeat="tag in tags"
                                    value='<%=tag.entityKey%>'>
                                <%=tag.name%>
                            </option>
                        </select>
                    </div>
            </div>
            <div class="modal-footer">
                <button class="btn" data-dismiss="modal" aria-hidden="true">{{ _("Cancel") }}</button>
                <input ng-hide="isLoadingTask" ng-click="addTagsTothis()" type="submit" class="btn green"
                       value="{{ _('Add') }}">
                <input ng-show="isLoadingTask" type="submit" class="btn green" value="Loading..." disabled>
            </div>
            </form>
        </div>
    </div>
</div>
<!--Event Modal -->
<div id="newTimeModalForm" class="modal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">

            <div class="modal-body">
                <form id="addTask" class="ng-pristine ng-valid">
                    <div class="inner-addon left-addon">
                        <i class="glyphicon glyphicon-pencil"
                           style="color: rgba(0, 26, 131, 0.61);   margin-top: -10px;"></i>
                        <input class="form-control calendar-form-controle" autofocus type="text"
                               placeholder="{{_('Title ...')}}" id="taskTitle" ng-model="ioevent.title"
                               style="padding-bottom: 20px;">
                    </div>
                    <div class="row">
                        <div class="col-md-8">
                            <div class="oppEstDate" style="display: inline-block; float: left; max-width: 75%;">
                                <div class="input-icon">
                                    <i class="fa fa-calendar"></i>
                                    <input lang="de" cdatetimepicker data-model="ioevent.starts_at_allday" type="text"
                                           class="form-control calendar-form-controle"
                                           placeholder="{{ _('mm/dd/yyyy hh:mm am')}}" value="" id="">
                                </div>

                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-12">
                            <div class="dropdown">
                                <button class="btn btn-default dropdown-toggle" type="button" id="dropdownMenu1"
                                        data-toggle="dropdown" aria-expanded="true"
                                        style="  border: none !important;color: rgba(0, 0, 0, 0.44);">

                                    <i class="glyphicon glyphicon-bell"
                                       style="color: rgba(0, 26, 131, 0.61); margin-left: -4px;"></i>
                                    <span>Remind me</span>
                                    <span class="caret"></span>

                                </button>
                                <span ng-show="something_picked"
                                      style="border: 1px solid rgba(10, 18, 168, 0.258824);padding: 3px; color: rgb(108, 108, 108);border-radius: 3px !important;background-color: rgba(154, 157, 205, 0.258824);"> <%=remindme_show %><a
                                        href="" ng-click="deletePicked()" class=" calendar-close-invite"
                                        style=" top: 2px !important;"></a></span>

                                <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenu1">
                                    <li role="presentation"><a role="menuitem" tabindex="-1" ng-click="Remindme(0)">No
                                        notification</a></li>
                                    <li role="presentation"><a role="menuitem" tabindex="-1" ng-click="Remindme(1)"> At
                                        time of event</a></li>
                                    <li role="presentation"><a role="menuitem" tabindex="-1" ng-click="Remindme(2)">30
                                        minutes before</a></li>
                                    <li role="presentation"><a role="menuitem" tabindex="-1" ng-click="Remindme(3)">1
                                        hour </a></li>
                                    <li role="presentation"><a role="menuitem" tabindex="-1" ng-click="Remindme(4)">1
                                        day </a></li>
                                    <li role="presentation"><a role="menuitem" tabindex="-1" ng-click="Remindme(5)">1
                                        week </a></li>

                                </ul>
                            </div>
                        </div>
                    </div>

                </form>
            </div>
            <div class="modal-footer " style="border-top:none!important;">
                <button class="btn" data-dismiss="modal" aria-hidden="true" ng-click="cancelAddOperation()">
                    {{_("Cancel")}}
                </button>

                <input ng-hide="isLoading" type="submit" class="btn red" value="{{_('Add')}}"
                       ng-click="addEvent(ioevent)">
                <input ng-show="isLoading" type="submit" class="btn green" value="{{_('Loading...')}}" disabled>


            </div>
        </div>
    </div>
</div>
<div id="beforedelinkContact" class="modal in" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"
     aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">×</button>
                <h3 id="myModalLabel" class="modal-title"
                    style="text-align: center;font-size: 22px;font-weight: 500 !important;"><i
                        class="fa  fa-chain-broken" style="font-size: 18px;"></i>{{ _(" Disassociate a
                    <%=itemToDisassociate.type%> from this opportunity")}}</h3>
            </div>
            <div class="modal-body">
                <form id="seletesho" name="deletesho" class="form-horizontal">
                    <p style="font-size: 16px;text-align: center;">{{_("Are you sure you want to disassociate ")}} <span
                            style="color:blue"><%= itemToDisassociate.item.firstname ||itemToDisassociate.item.name%> <%= itemToDisassociate.item.lastname || '' %></span>
                    </p>

                    <p style="font-size: 16px;text-align: center;">
                        {{_("from")}} this opportunity ?
                    </p>
            </div>
            <div class="modal-footer">
                <button class="btn" data-dismiss="modal" aria-hidden="true">{{_("Cancel")}}</button>

                <input ng-click="disassociateItem()" type="submit" class="btn red" value="Disassociate">
                <!--input ng-show="isLoading" type="submit" class="btn green" value="Loading..." disabled-->
            </div>
            </form>
        </div>
    </div>
</div>
<script type="text/javascript">
function wizz(){
  if (!jQuery().bootstrapWizard) {
                    return;
                }
      var handleTitle = function(tab, navigation, index) {
          var total = navigation.find('li').length;
          var current = index + 1;
          // set wizard title
         // $('.step-title', $('#form_wizard_1')).text('Step ' + (index + 1) + ' of ' + total);
          // set done steps
          jQuery('li', $('#form_wizard_1')).removeClass("done");
          var li_list = navigation.find('li');
          for (var i = 0; i < index; i++) {
              jQuery(li_list[i]).addClass("done");
          }

          if (current == 1) {
              $('#form_wizard_1').find('.button-previous').hide();
          } else {
              $('#form_wizard_1').find('.button-previous').show();
          }

          if (current >= total) {
              $('#form_wizard_1').find('.button-next').hide();
              $('#form_wizard_1').find('.button-submit').show();
             // displayConfirm();
          } else {
              $('#form_wizard_1').find('.button-next').show();
              $('#form_wizard_1').find('.button-submit').hide();
          }
        //  App.scrollTo($('.page-title'));
      }

      // default form wizard
      $('#form_wizard_1').bootstrapWizard({
          'nextSelector': '.button-next',
          'previousSelector': '.button-previous',
          onTabClick: function (tab, navigation, index, clickedIndex) {
              handleTitle(tab, navigation, clickedIndex);
          },
          onNext: function (tab, navigation, index) {
              handleTitle(tab, navigation, index);
          },
          onPrevious: function (tab, navigation, index) {
              handleTitle(tab, navigation, index);
          },
          onTabShow: function (tab, navigation, index) {
              var total = navigation.find('li').length;
              var current = index + 1;
              var $percent = (current / total) * 100;
              $('#form_wizard_1').find('.progress-bar').css({
                  width: $percent + '%'
              });
          }
      });
      $('#form_wizard_1').find('.button-previous').hide();
      $('#form_wizard_1 .button-submit').click(function () {}).hide();
}
function waitwizard() {
      if (angular.element("#signin").scope().opportunity==undefined||jQuery.isEmptyObject(angular.element("#signin").scope().insideStages)) {
          setTimeout("waitwizard()", 500);
      }else{
          if(angular.element("#signin").scope().opportunity.id!=undefined&&!jQuery.isEmptyObject(angular.element("#signin").scope().insideStages)) {
                 wizz()// you will need an asynch callback
          } else {
            console.log("not yet")
            setTimeout("waitwizard()", 500); // poll in a half second
          }
    }
}


  $(function() {
   waitwizard();
    $('#datetimepicker2').datetimepicker({
      language: 'fr',
      pickTime: false
    });
  });
   $('#collaborators').slimScroll({
           height: '192px'
   });
    $('.waterfall').waterfall({
        colMinWidth: 210,
        defaultContainerWidth: 800,
        autoresize: true
  });
  $("#select2_sample2").select2({
      placeholder: "{{_('Click to Select a label')}}",
      allowClear: false
  });
  
</script>
